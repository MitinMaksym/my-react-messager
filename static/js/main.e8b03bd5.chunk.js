(this.webpackJsonpchat=this.webpackJsonpchat||[]).push([[0],{256:function(e,t,a){e.exports=a.p+"static/media/play.65f03140.svg"},257:function(e,t,a){e.exports=a.p+"static/media/wave.2b8196a5.svg"},258:function(e,t,a){e.exports=a.p+"static/media/pause.a61933e8.svg"},260:function(e,t,a){e.exports=a.p+"static/media/readed.c1f419d6.svg"},261:function(e,t,a){e.exports=a.p+"static/media/noreaded.3c841bf6.svg"},284:function(e,t,a){e.exports=a(563)},291:function(e,t,a){var n={"./":95,"./app":97,"./app.js":97,"./attachments":98,"./attachments.js":98,"./dialogs":72,"./dialogs.js":72,"./index":95,"./index.js":95,"./messages":61,"./messages.js":61,"./user":99,"./user.js":99};function r(e){var t=s(e);return a(t)}function s(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=s,e.exports=r,r.id=291},292:function(e,t,a){},333:function(e,t,a){},334:function(e,t,a){},335:function(e,t,a){},348:function(e,t,a){},429:function(e,t,a){},435:function(e,t,a){},455:function(e,t,a){},459:function(e,t,a){},522:function(e,t){},560:function(e,t,a){},561:function(e,t,a){},562:function(e,t,a){},563:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(4),c=a.n(s),i=a(27),o=a(24),u=a(43),l=a(253),d=a(95),m=[l.a],p=("object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):u.d)(u.a.apply(void 0,m)),f=Object(u.e)(d.default,p),E=a(63),g=a(2),h=a.n(g),v=(a(292),function(e){return r.a.createElement(E.a,Object.assign({},e,{className:h()("button",e.className,{"button--large":"large"===e.size})}))});a(333);function _(e){var t=e.children,a=e.className;return r.a.createElement("div",{className:h()("block",a)},t)}var b=a(13),S=function(e,t,a){return t[e]?a[e]?"error":"success":""},y=a(127),w=a.n(y),O=function(e){var t=e.substr(11,14).split("").map((function(e){return(t=e).charCodeAt(0)>255?255:t.charCodeAt(0)<0?0:t.charCodeAt(0);var t})),a=Object(b.a)(t,3),n=a[0],r=a[1],s=a[2];return{color:w()({r:n,g:r,b:s}).lighten(10).saturate(15).toHexString(),colorLighten:w()({r:n,g:r,b:s}).lighten(30).saturate(30).toHexString()}},I=a(571),A=function(e){var t=e.type,a=e.message,n=e.description,r=e.duration;I.a[t]({message:a,description:n,duration:r})},j=function(e){if(!e)return null;var t=e[0];return e.length&&"webm"===t.ext},x=a(564),D=a(256),T=a.n(D),N=a(257),M=a.n(N),R=a(258),k=a.n(R);a(334);function L(e){var t=e.user;if(t){if(t.avatar)return r.a.createElement("img",{src:t.avatar,className:"avatar",alt:"Avatar ".concat(t.fullname)});var a=O(t._id),n=a.color,s=a.colorLighten,c=t.fullname[0].toUpperCase();return r.a.createElement("div",{style:{background:"linear-gradient(135deg, ".concat(n," 0%, ").concat(s," 96.52%)")},className:"avatar avatar--symbol"},c)}}a(335);var C=a(197).Emojione,U=function(e){var t=e.audioSrc,a=Object(n.useState)(!1),s=Object(b.a)(a,2),c=s[0],i=s[1],o=Object(n.useState)(0),u=Object(b.a)(o,2),l=u[0],d=u[1],m=Object(n.useState)(0),p=Object(b.a)(m,2),f=p[0],E=p[1],g=Object(n.useRef)(null);return Object(n.useEffect)((function(){g.current.addEventListener("playing",(function(){return i(!0)})),g.current.addEventListener("ended",(function(){i(!1),E(0),d(0)})),g.current.addEventListener("pause",(function(){return i(!1)})),g.current.addEventListener("timeupdate",(function(){var e=g.current&&g.current.duration||0;d(g.current.currentTime),E(g.current.currentTime/e*100)}))}),[]),r.a.createElement("div",{className:"message__audio"},r.a.createElement("audio",{src:t,ref:g,preload:"auto"}),r.a.createElement("div",{style:{width:f+"%"},className:"message__audio-progress"}),r.a.createElement("div",{className:"message__audio-info"},r.a.createElement("div",{className:"message__audio-btn"},r.a.createElement("button",{onClick:function(){c?g.current.pause():g.current.play()}},c?r.a.createElement("img",{src:k.a,alt:"Pause swg"}):r.a.createElement("img",{src:T.a,alt:"Play swg"}))),r.a.createElement("div",{className:"message__audio-wave"},r.a.createElement("img",{src:M.a,alt:"Wave svg"})),r.a.createElement("div",{className:"message__audio-duration"},function(e){var t=Math.floor(e/60),a=(e%60).toFixed();return"".concat(t<10?"0":"").concat(t,":").concat(a<10?"0":"").concat(a)}(l))))},G=function(e){var t=e.createdAt,a=e.text,n=e.user,s=e.date,c=e.isMe,i=e.attachments,o=e.isTyping,u=e.audio,l=e.readed,d=e.onRemoveMessage,m=e.setImageUrl,p=function(e){m(e)};return r.a.createElement("div",{className:h()("message",{"message--isme":c,"message--is-typing":o,"message--image":i&&1===i.length&&!a,"message--is-audio":j(i)})},r.a.createElement("div",{className:"message__content"},r.a.createElement($,{isMe:c,isReaded:l}),c&&r.a.createElement("div",{className:"message__icon-actions"},r.a.createElement(x.a,{content:r.a.createElement("div",null,r.a.createElement(E.a,{onClick:d},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435")),trigger:"click"},r.a.createElement(E.a,{type:"link",shape:"circle",icon:"ellipsis"}))),r.a.createElement("div",{className:"message__avatar"},r.a.createElement(L,{user:n})),r.a.createElement("div",{className:"message__info"}," ",(o||a)&&r.a.createElement("div",{className:"message__bubble"},a&&r.a.createElement("p",{className:"message__text"},r.a.createElement(C,{text:a})),o&&r.a.createElement("div",{className:"message__typing"},r.a.createElement("span",null),r.a.createElement("span",null),r.a.createElement("span",null)),u&&r.a.createElement(U,{audioSrc:u})),i&&r.a.createElement("div",{className:"message__attachments"},i.map((function(e){return function(e){return"webm"!==e.ext?r.a.createElement("div",{key:e._id,className:"message__attachments-item"},r.a.createElement("img",{src:e.url.replace(/http/,"https"),alt:e.filename,onClick:function(){p(e.url)}})):r.a.createElement(U,{key:e._id,audioSrc:e.url})}(e)}))),s&&r.a.createElement("span",{className:"message__date"},r.a.createElement(X,{date:new Date(t)})))))};G.defaultProps={user:{}};var V=G,P=a(182),z=a(8),H=a(280),F=a(197).Emojione;function B(e){var t,a=e._id,n=e.isMe,s=e.partner,c=e.lastMessage,o=e.author,u=e.currentDialogId,l=e.userId,d=n?s:o;return r.a.createElement(i.b,{to:"/dialog/".concat(a)},r.a.createElement("div",{className:h()("dialogs__item",{"dialogs__item--online":d.isOnline,"dialogs__item--active":u===a})},r.a.createElement("div",{className:"dialogs__item-avatar"},r.a.createElement(L,{user:d})),r.a.createElement("div",{className:"dialogs__item-info"},r.a.createElement("div",{className:"dialogs__item-info-top"},r.a.createElement("b",null,d.fullname),c&&r.a.createElement("span",null,(t=new Date(c.createdAt),Object(H.a)(new Date(t))?Object(P.a)(new Date(t),"HH:mm"):Object(P.a)(new Date(t),"dd.MM.yyyy")))),c&&r.a.createElement("div",{className:"dialogs__item-info-bottom"},r.a.createElement("p",null,function(e,t){var a="";return a=!e.text&&e.attachments?"\u043f\u0440\u0438\u043a\u0440\u0435\u043f\u043b\u0435\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b":e.text,r.a.createElement(F,{text:"".concat(e.user._id===t?"\u0412\u044b: ":""," ").concat(a)})}(c,l)),r.a.createElement($,{isMe:l===c.user._id,isReaded:c.readed}),c.user._id!==l&&!1===c.readed&&r.a.createElement("div",{className:"dialogs__item-info-bottom-count"},r.a.createElement(z.a,{type:"mail"}))))))}var Z=a(278),W=a(279);function X(e){var t=e.date;return r.a.createElement(n.Fragment,null,Object(Z.a)(t,{addSuffix:!0,locale:W.a}))}var q=a(260),Y=a.n(q),J=a(261),K=a.n(J);a(348);function $(e){var t=e.isMe,a=e.isReaded;return r.a.createElement("div",null,t&&(a?r.a.createElement("img",{className:"message__icon-readed",src:Y.a,alt:"Readed icon"}):r.a.createElement("img",{className:"message__icon-readed message__icon-readed--no",src:K.a,alt:"No readed icon"})))}var Q=a(262),ee=a.n(Q),te=a(569),ae=a(565),ne=a(85);a(429);function re(e){var t=e.items,a=e.userId,n=e.onSearch,s=e.inputValue,c=e.isLoading,i=e.currentDialogId,o=te.a.Search;return r.a.createElement("div",{className:"dialogs"},r.a.createElement("div",{className:"dialogs__search"},r.a.createElement(o,{value:s,onChange:function(e){n(e.target.value)},placeholder:"\u041f\u043e\u0438\u0441\u043a \u0441\u0440\u0435\u0434\u0438 \u043a\u043e\u043d\u0442\u0430\u043a\u0442\u043e\u0432"})),r.a.createElement("div",null,c?r.a.createElement(ae.a,{tip:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0438\u0430\u043b\u043e\u0433\u043e\u0432"}):t?t.length>0?ee()(t,["created_at"],["desc"]).map((function(e){return r.a.createElement(B,Object.assign({key:e._id,isMe:e.author._id===a,userId:a,currentDialogId:i},e))})):r.a.createElement(ne.a,{description:"\u041d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"}):null))}a(435);function se(e){var t=e.online,a=e.fullname;return r.a.createElement("div",{className:"chat__dialog-header-center"},r.a.createElement("b",{className:"chat__dialog-header-username"},a),r.a.createElement("div",{className:"chat__dialog-header-status"}),r.a.createElement("div",{className:h()("status",{"status--online":t})},t?"\u043e\u043d\u043b\u0430\u0439\u043d":"\u043e\u0444\u043b\u0430\u0439\u043d"))}var ce=a(277),ie=(a(450),a(267)),oe=(a(455),function(e){var t=e.value,a=e.setValue,s=e.toggleEmoji,c=e.emojiVisible,i=e.addEmoji,o=e.selectFile,u=e.attachments,l=e.removeAttachment,d=e.isDisabled,m=e.inputRef,p=e.handleSendMessage,f=e.onSendMessage,g=e.isRecording,h=e.onStopRecording,v=e.onRecord,_=e.isLoading;return r.a.createElement(n.Fragment,null,r.a.createElement("div",{ref:m,className:"chat-input"},r.a.createElement("div",null,r.a.createElement("div",{className:"chat-input__smile-btn"},r.a.createElement("div",{className:"chat-input__emoji-picker"},c&&r.a.createElement(ce.a,{onSelect:i})),r.a.createElement(E.a,{onClick:s,type:"link",shape:"circle",icon:"smile"})),g?r.a.createElement("div",{className:"chat-input__record-status"},r.a.createElement("i",{className:"chat-input__record-status-bubble"}),"Recording...",r.a.createElement(E.a,{className:"stop-recording",type:"link",shape:"circle",icon:"close",onClick:h})):r.a.createElement(te.a.TextArea,{onChange:function(e){/^\s/.test(e.target.value)||a(e.target.value)},placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f",autoSize:{minRows:2,maxRows:8},allowClear:!0,value:t,onKeyUp:p,disabled:d}),r.a.createElement("div",{className:"chat-input__actions"},t||u.length||g?r.a.createElement(E.a,{disabled:d,onClick:f,size:"large",type:"link",icon:"right-circle"}):r.a.createElement("div",{className:"chat-input__record-btn"},_?r.a.createElement(z.a,{type:"loading",shape:"circle"}):r.a.createElement(E.a,{onClick:v,type:"link",shape:"circle",icon:"audio",size:"large"})),r.a.createElement(ie.UploadField,{onFiles:o,containerProps:{className:"chat-input__actions-upload-btn"},uploadProps:{accept:".jpg,.jpeg,.png,.gif,.bmp",multiple:"multiple"}},r.a.createElement(E.a,{type:"link",shape:"circle",icon:"camera"}))))),r.a.createElement("div",null,r.a.createElement(ct,{attachments:u,removeAttachment:l})))}),ue=a(268),le=a.n(ue),de=a(570),me=(a(459),function(e){var t,a=e.items,n=e.isLoading,s=e.boxRef,c=e.currentDialogId,i=e.userId,o=e.removeMessageById,u=e.attachments,l=e.setImageUrl,d=e.showImage,m=e.setShowImage,p=e.imageUrl,f=e.dialogsItems,E=e.isTyping,g=f&&le()(f,{_id:c});g&&(t=g.partner.id===i?g.author:g.partner);return r.a.createElement("div",{className:h()("chat__dialog-messages",{"chat__dialog-messages-attachments":u.length})},r.a.createElement("div",{ref:s,className:h()("messages",{"messages--loading":n})},n?r.a.createElement(ae.a,{size:"large",tip:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439..."}):a&&!n&&c?a.length>0?a.map((function(e){return r.a.createElement(V,Object.assign({key:e._id,alt:"User avatar",text:e.text,date:new Date,isMe:e.user._id===i},e,{isTyping:!1,onRemoveMessage:o.bind(void 0,e._id),setImageUrl:l}))})):r.a.createElement(ne.a,{description:"\u0414\u0438\u0430\u043b\u043e\u0433 \u043f\u0443\u0441\u0442"}):r.a.createElement(ne.a,{description:"\u0412\u0438\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0438\u0430\u043b\u043e\u0433"})," ",E&&!n&&r.a.createElement(V,{isTyping:!0,user:t})),p&&r.a.createElement(de.a,{visible:d,footer:null,onCancel:function(){m(!1),l(null)}},r.a.createElement("img",{alt:"previewImg",style:{width:"100%"},src:p})))}),pe=a(568);function fe(e){var t=e.errors,a=e.type,n=e.icon,s=e.placeholder,c=e.handleChange,i=e.handleBlur,o=e.id,u=e.touched;return r.a.createElement(pe.a.Item,{help:u[o]&&t[o],validateStatus:S(o,u,t),hasFeedback:!0}," ",r.a.createElement(te.a,{prefix:r.a.createElement(z.a,{type:n,style:{color:"rgba(0,0,0,.25)"}}),type:a,placeholder:s,id:o,onChange:c,onBlur:i}))}var Ee=a(566),ge=a(273),he=a.n(ge)()("https://my-messager-api.herokuapp.com/"),ve=a(84),_e=a(5),be=a.n(_e),Se=a(106),ye=a.n(Se);ye.a.defaults.baseURL="https://my-messager-api.herokuapp.com/",ye.a.defaults.headers.common.token=window.localStorage.token,window.axios=ye.a;var we=ye.a,Oe=function(){return we.get("dialogs")},Ie=function(e){var t,a,n;return be.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.partner,a=e.text,r.next=3,be.a.awrap(we.post("dialogs",{partner:t,text:a}));case 3:return n=r.sent,r.abrupt("return",n.data);case 5:case"end":return r.stop()}}))},Ae=function(e){return we.get("messages?dialog="+e)},je=function(e){var t=e.text,a=e.currentDialogId,n=e.attachments;return we.post("messages",{text:t,attachments:n,dialog_id:a})},xe=function(e){var t;return be.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,be.a.awrap(we.delete("messages?id="+e));case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}))},De=function(e){return we.post("user/login",e)},Te=function(){return we.get("user/me")},Ne=function(e){return we.post("user/registration",e)},Me=function(e){var t;return be.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,be.a.awrap(we.get("user/verify?hash=".concat(e)));case 2:return t=a.sent,a.abrupt("return",t);case 4:case"end":return a.stop()}}))},Re=function(e){var t;return be.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,be.a.awrap(we.get("user/find?query=".concat(e)));case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}))},ke=function(e){var t,a;return be.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return(t=new FormData).append("file",e),n.next=4,be.a.awrap(we.post("files",t,{headers:{"content-type":"multipart/form-data"}}));case 4:return a=n.sent,n.abrupt("return",a.data);case 6:case"end":return n.stop()}}))},Le=a(72),Ce=a(61),Ue={setCurrentDialog:function(e){return{type:Le.SET_CURRENT_DIALOG,payload:e}},setItems:function(e){return{type:Le.SET_ITEMS,payload:e}},fetchDialogs:function(){return function(e){var t;return be.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return e(Ue.setIsLoading(!0)),a.next=3,be.a.awrap(Oe());case 3:t=a.sent,e(Ue.setItems(t.data)),e(Ue.setIsLoading(!1));case 6:case"end":return a.stop()}}))}},updateDialog:function(e){return{type:Le.UPDATE_DIALOG,payload:e}},updateDialogs:function(e){var t=e.operation,a=void 0===t?"":t,n=e.item;return function(e,t){var r=t();if("SERVER:CREATE_DIALOG"===a){var s=r.dialogs.items,c=r.user.data.user._id,i=n.author._id;(c===n.partner._id||c===i)&&e(Ue.setItems([].concat(Object(ve.a)(s),[n])))}else if("SERVER:NEW_MESSAGE"===a||"SERVER:DELETE_MESSAGE"===a){r.dialogs.items.some((function(e){return e._id===n.dialog._id}))&&(e(Ue.updateDialog(n.dialog)),"SERVER:DELETE_MESSAGE"===a&&e({type:Ce.REMOVE_MESSAGE,payload:n._id}))}}},createDialog:function(e){var t=e.partner,a=e.text;return function(e){var n;return be.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,be.a.awrap(Ie({partner:t,text:a}));case 3:return n=e.sent,e.abrupt("return",n);case 7:e.prev=7,e.t0=e.catch(0),403===e.t0.response.status?A({type:"error",message:"\u0422\u0430\u043a\u043e\u0439 \u0434\u0438\u0430\u043b\u043e\u0433 \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442"}):A({type:"error",message:"\u041e\u0448\u0438\u0431\u043a\u0430"});case 10:case"end":return e.stop()}}),null,null,[[0,7]])}},setIsLoading:function(e){return{type:Le.SET_IS_LOADING,payload:e}}},Ge=Ue,Ve={setMessages:function(e){return{type:Ce.SET_ITEMS,payload:e}},fetchMessages:function(e){return function(t){t(Ve.setIsLoading(!0)),Ae(e).then((function(e){var a=e.data;t(Ve.setMessages(a)),t(Ve.setIsLoading(!1))}))}},addMessage:function(e){return function(t,a){var n=a().dialogs,r=a().user.data.user._id;n.currentDialogId===e.dialog._id&&(t({type:Ce.ADD_MESSAGE,payload:e}),r!==e.user._id&&(Ae(e.dialog._id),t(Ge.updateDialog(e.dialog))))}},updateUnreadMessages:function(e){var t=e.messages,a=e.dialog;return function(e,n){var r,s,c,i,o;return be.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return r=n().user.data.user._id,u.next=3,be.a.awrap(n().dialogs.currentDialogId);case 3:if(s=u.sent,c=a.author._id,i=a.partner._id,!(r===i||r===c)){u.next=20;break}if(!a||a._id!==s){u.next=19;break}if(o=n().messages.items.filter((function(e){return e.dialog._id===s&&e.user._id===r})),!o.some((function(e){return!0!==e.readed}))){u.next=16;break}return u.next=14,be.a.awrap(e(Ve.setMessages(t)));case 14:return u.next=16,be.a.awrap(e(Ge.updateDialog(a)));case 16:e(Ge.updateDialog(a)),u.next=20;break;case 19:e(Ge.updateDialog(a));case 20:case"end":return u.stop()}}))}},removeMessageById:function(e){return function(t){return be.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,be.a.awrap(xe(e));case 2:case"end":return t.stop()}}))}},sendMessage:function(e){var t=e.text,a=e.currentDialogId,n=e.attachments;return function(e){return je({text:t,currentDialogId:a,attachments:n})}},setIsLoading:function(e){return{type:Ce.SET_IS_LOADING,payload:e}}},Pe=Ve,ze=a(99),He={setAuth:function(e){return{type:ze.SET_IS_AUTH,payload:e}},setUserData:function(e){return{type:ze.SET_USER_DATA,payload:e}},fetchUserData:function(){return function(e){var t;return be.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,be.a.awrap(Te());case 3:if("success"!==(t=a.sent).data.status){a.next=7;break}return e(He.setUserData(t.data)),a.abrupt("return",t);case 7:a.next=17;break;case 9:if(a.prev=9,a.t0=a.catch(0),403!==a.t0.response.status){a.next=16;break}delete window.localStorage.token,window.axios.defaults.headers.common.token="",a.next=17;break;case 16:throw new Error(a.t0);case 17:case"end":return a.stop()}}),null,null,[[0,9]])}},signOut:function(){return function(e){return be.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:e(He.setAuth(!1)),e(He.setUserData(null)),e(Ge.setItems([])),e(Pe.setMessages([])),delete window.localStorage.token,e(Ge.setCurrentDialog(null));case 6:case"end":return t.stop()}}))}},fetchLoginData:function(e){return function(t){var a,n;return be.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,be.a.awrap(De(e));case 3:if("success"!==(a=t.sent).data.status){t.next=10;break}return n=a.data.token,window.localStorage.token=n,window.axios.defaults.headers.common.token=n,A({type:"success",message:"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f \u043f\u0440\u043e\u0439\u0448\u043b\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e!",duration:1}),t.abrupt("return",a.data);case 10:t.next=16;break;case 12:t.prev=12,t.t0=t.catch(0),console.log(t.t0),404===t.t0.response.status?A({type:"error",message:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438",description:"\u0422\u0430\u043a\u043e\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d"}):401===t.t0.response.status?A({type:"error",message:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438",description:"\u0412\u0430\u0448 \u0430\u043a\u043a\u0430\u0443\u043d\u0442 \u043d\u0435 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d"}):(delete window.localStorage.token,window.axios.defaults.headers.common.token="",A({type:"error",message:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438",description:"\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043b\u043e\u0433\u0438\u043d \u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c"}));case 16:case"end":return t.stop()}}),null,null,[[0,12]])}},signUserUp:function(e){return function(t){var a;return be.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,be.a.awrap(Ne(e));case 3:return a=t.sent,t.abrupt("return",a);case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0),400===t.t0.response.status?A({type:"error",message:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438",description:"\u0422\u0430\u043a\u043e\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0443\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d"}):A({type:"error",message:"Server Error",description:"Something went wrong"});case 11:case"end":return t.stop()}}),null,null,[[0,7]])}}},Fe=He,Be=a(97),Ze={initializeApp:function(){return function(e,t){if(t().user.isAuth){var a=e(Fe.fetchUserData());Promise.all([a]).then((function(t){e({type:Be.INITIALIZED_SUCCESS})}))}else e({type:Be.INITIALIZED_SUCCESS})}}},We=a(98),Xe={setAttachments:function(e){return{type:We.SET_ATTACHMENTS,payload:e}},removeAttachment:function(e){return{type:We.REMOVE_ATTACHMENT,payload:e}},upload:function(e){return function(t){var a;return be.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,be.a.awrap(ke(e));case 2:if(!(a=t.sent)||"success"!==a.status){t.next=5;break}return t.abrupt("return",a.file);case 5:case"end":return t.stop()}}))}}},qe=r.a.memo((function(e){var t=e.items,a=e.fetchDialogs,s=e.isLoading,c=e.userId,i=e.currentDialogId,o=e.updateDialogs,u=Object(n.useState)(""),l=Object(b.a)(u,2),d=l[0],m=l[1],p=Object(n.useState)(Array.from(t)),f=Object(b.a)(p,2),E=f[0],g=f[1],h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"SERVER:CREATE_DIALOG";o({operation:t,item:e})},v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"SERVER:DELETE_MESSAGE";o({operation:t,item:e})},_=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"SERVER:NEW_MESSAGE";o({operation:t,item:e})};return Object(n.useEffect)((function(){g(t)}),[t]),Object(n.useEffect)((function(){return a(),he.on("SERVER:CREATE_DIALOG",h),he.on("SERVER:DELETE_MESSAGE",v),he.on("SERVER:NEW_MESSAGE",_),function(){he.removeListener("SERVER:CREATE_DIALOG",h),he.removeListener("SERVER:NEW_MESSAGE",_),he.removeListener("SERVER:DELETE_MESSAGE",v)}}),[]),r.a.createElement(re,{items:E,onSearch:function(e){m(e),g(t.filter((function(t){return(c===t.author._id?t.partner:t.author).fullname.toLowerCase().indexOf(e)>=0})))},inputValue:d,isLoading:s,userId:c,currentDialogId:i})})),Ye=Object(o.b)((function(e){var t=e.dialogs,a=e.user;return{items:t.items,isLoading:t.isLoading,userId:a.data.user._id,currentDialogId:t.currentDialogId}}),Ge)(qe),Je=Object(o.b)((function(e){var t=e.dialogs,a=e.messages,n=e.attachments;return{userId:e.user.data.user._id,items:a.items,dialogsItems:t.items,currentDialogId:t.currentDialogId,isLoading:a.isLoading,attachments:n.items}}),Pe)((function(e){var t=e.items,a=e.fetchMessages,s=e.currentDialogId,c=e.isLoading,i=e.addMessage,o=e.removeMessageById,u=e.updateUnreadMessages,l=e.attachments,d=e.userId,m=e.dialogsItems,p=Object(n.useState)(null),f=Object(b.a)(p,2),E=f[0],g=f[1],h=Object(n.useState)(!1),v=Object(b.a)(h,2),_=v[0],S=v[1],y=Object(n.useState)(!1),w=Object(b.a)(y,2),O=w[0],I=w[1],A=null,j=function(e){e.dialogId===s&&(I(!0),clearInterval(A),A=setTimeout((function(){I(!1)}),3e3))},x=function(e){i(e)},D=function(e){u(e)},T=Object(n.useCallback)((function(e){setTimeout((function(){null!==e&&e.scrollTo(0,99999)}))}),[t]);return Object(n.useEffect)((function(){E&&S(!0)}),[E]),Object(n.useEffect)((function(){return null!==s&&a(s),he.on("SERVER:NEW_MESSAGE",x),he.on("SERVER:UPDATE_UNREADED_MESSAGES",D),he.on("DIALOGS:TYPING",j),he.on("SERVER:DELETE_MESSAGE",(function(e){})),function(){he.removeListener("SERVER:NEW_MESSAGE",x),he.removeListener("SERVER:UPDATE_UNREADED_MESSAGES",D),he.removeListener("DIALOGS:TYPING",j)}}),[s]),s?r.a.createElement(me,{boxRef:T,items:t,isLoading:c,currentDialogId:s,removeMessageById:o,attachments:l,setImageUrl:g,showImage:_,setShowImage:S,imageUrl:E,userId:d,dialogsItems:m,isTyping:O}):r.a.createElement(ne.a,{description:"\u0412\u0438\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0438\u0430\u043b\u043e\u0433"})})),Ke=a(19),$e=Object(o.b)((function(e){var t=e.dialogs,a=e.attachments;e.user;return{currentDialogId:t.currentDialogId,attachments:a.items}}),Object(Ke.a)({},Pe,{},Xe))((function(e){var t=e.currentDialogId,a=e.sendMessage,s=e.upload,c=e.setAttachments,i=e.removeAttachment,o=e.attachments,u=Object(n.useState)(""),l=Object(b.a)(u,2),d=l[0],m=l[1],p=Object(n.useState)(!1),f=Object(b.a)(p,2),E=f[0],g=f[1],h=Object(n.useState)(!1),v=Object(b.a)(h,2),_=v[0],S=v[1],y=Object(n.useState)(!1),w=Object(b.a)(y,2),O=w[0],I=w[1],A=Object(n.useState)(!1),j=Object(b.a)(A,2),x=j[0],D=j[1],T=Object(n.useState)(null),N=Object(b.a)(T,2),M=N[0],R=N[1];window.navigator.getUserMedia=window.navigator.getUserMedia||window.navigator.mozGetUserMedia||window.navigator.msGetUserMedia||window.navigator.webkitGetUserMedia;var k=function(e){var t=new MediaRecorder(e);R(t),t.start(),t.onstart=function(){I(!0)},t.onstop=function(){I(!1)},t.ondataavailable=function(e){var t=new File([e.data],"audio.webm");g(!0),ke(t).then((function(e){C(e.file._id).then((function(){g(!1)}))}))}},L=function(e){throw new Error(e)},C=function(e){return a({text:null,currentDialogId:t,attachments:[e]})},U=function(){O?M.stop():(d||o.length)&&(a({text:d,currentDialogId:t,attachments:o.map((function(e){return e.uid}))}),m(""),c([]))},G=function(e,t){t&&!t.contains(e.target)&&S(!1)},V=Object(n.useCallback)((function(e){if(console.log(d.length),e){console.log(e.offsetHeight);var t=e.offsetHeight+40+93.5;o.length>0&&(t+=112);var a=document.querySelector(".chat__dialog-messages");a&&(a.style.height="calc(100% - ".concat(t,"px)"),0!==d.length||o.length||(a.style.height="calc(100% - 185.5px)"))}}),[d,o]);return Object(n.useEffect)((function(){var e=document.querySelector(".chat-input__smile-btn");return document.addEventListener("click",(function(t){return G(t,e)})),function(){document.removeEventListener("click",(function(t){G(t,e)}))}}),[t]),t?t&&r.a.createElement(oe,{inputRef:V,value:d,setValue:m,toggleEmoji:function(){S(!_)},emojiVisible:_,setEmojiVisible:S,addEmoji:function(e){m(d+e.native)},selectFile:function(e){var t,a,n;return be.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:t=o.length?o:[],a=function(a){var n,r;return be.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return n=e[a],r=Math.random(1e3*Math.random()),t=[].concat(Object(ve.a)(t),[{uid:r,name:n.name,status:"done",url:"https://cdn.lowgif.com/small/dc86e54ceca03be4-loading-spinner-animated-gif-83320-mediabin.gif"}]),c(t),D(!0),i.next=7,be.a.awrap(s(n).then((function(e){t=t.map((function(t){return t.uid===r?{uid:e._id,name:e.filename,status:"done",url:e.url.replace(/http/,"https")}:t}))})));case 7:case"end":return i.stop()}}))},n=0;case 3:if(!(n<e.length)){r.next=9;break}return r.next=6,be.a.awrap(a(n));case 6:n++,r.next=3;break;case 9:c(t),D(!1);case 11:case"end":return r.stop()}}))},attachments:o,removeAttachment:i,isDisabled:x,handleSendMessage:function(e){he.emit("DIALOGS:TYPING",{dialogId:t}),(d.length||o.length)&&13===e.keyCode&&U()},onSendMessage:U,isRecording:O,handleStartRecording:function(){I(!0)},onStopRecording:function(){I(!1)},onRecord:function(){navigator.getUserMedia&&navigator.getUserMedia({audio:!0},k,L)},isLoading:E}):null})),Qe=Object(o.b)((function(e){var t=e.dialogs,a=e.user;return{currentDialogId:t.currentDialogId,dialogs:t.items,userId:a.data.user._id}}))((function(e){var t=e.currentDialogId,a=e.dialogs,n=e.userId;if(a.length<1||!t)return null;var s=a.filter((function(e){return e._id===t}))[0];if(s){var c=n===s.author._id?s.partner:s.author;return r.a.createElement(se,{online:c.isOnline,fullname:c.fullname})}return null})),et=a(64),tt=Object(et.g)(Object(o.b)(null,Ge)((function(e){var t=Object(n.useState)(!1),a=Object(b.a)(t,2),s=a[0],c=a[1],i=Object(n.useState)(!1),o=Object(b.a)(i,2),u=o[0],l=o[1],d=Object(n.useState)([]),m=Object(b.a)(d,2),p=m[0],f=m[1],E=Object(n.useState)(""),g=Object(b.a)(E,2),h=g[0],v=g[1],_=Object(n.useState)(null),S=Object(b.a)(_,2),y=S[0],w=S[1],O=Object(n.useState)(void 0),I=Object(b.a)(O,2),A=I[0],j=I[1];return r.a.createElement(nt,{isLoading:u,visible:s,showModal:function(){c(!0)},handleCancel:function(){c(!1),j(void 0),w(null),f([])},handleOk:function(){return be.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:l(!0),v(""),j(void 0),f([]),w(null),l(!1),c(!1),l(!1),c(!1),e.createDialog({text:h,partner:y}).then((function(t){t&&"success"===t.status&&e.history.push("/dialog/".concat(t.dialog._id))}));case 10:case"end":return t.stop()}}))},onInputSelect:function(e){w(e)},users:p,onSearch:function(e){var t;return be.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,be.a.awrap(Re(e));case 3:"success"===(t=a.sent).status&&f(t.users),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),console.error(a.t0);case 10:case"end":return a.stop()}}),null,null,[[0,7]])},onAddNewMessage:function(e){v(e.target.value)},partner:y,newMessageText:h,selectInputValue:A,onInputChange:function(e){j(e)}})}))),at=Ee.a.Option,nt=function(e){var t=e.isLoading,a=e.visible,n=e.modalText,s=e.showModal,c=e.handleCancel,i=e.handleOk,o=e.onInputSelect,u=e.onInputChange,l=e.users,d=e.onSearch,m=e.onAddNewMessage,p=e.partner,f=e.newMessageText,g=e.selectInputValue,h=l.map((function(e){return r.a.createElement(at,{key:e._id},e.fullname)}));return r.a.createElement("div",{className:"chat__sidebar"},r.a.createElement("div",{className:"chat__sidebar-header"},r.a.createElement("div",null,r.a.createElement(z.a,{type:"team"}),r.a.createElement("span",null,"\u0421\u043f\u0438\u0441\u043e\u043a \u0434\u0438\u0430\u043b\u043e\u0433\u043e\u0432")),r.a.createElement(E.a,{onClick:s,type:"link",shape:"circle",icon:"form"})),r.a.createElement("div",{className:"chat__sidebar-dialogs"},r.a.createElement(Ye,{userId:"dfgf9e7079856ccaa8abeef5b"})),r.a.createElement("div",null,r.a.createElement(de.a,{title:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0434\u0438\u0430\u043b\u043e\u0433",visible:a,confirmLoading:t,onCancel:c,footer:[r.a.createElement(E.a,{key:"back",onClick:c},"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"),r.a.createElement(E.a,{disabled:!f,key:"submit",type:"primary",loading:t,onClick:i},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c")]},r.a.createElement("p",null,n),r.a.createElement(pe.a,{className:"add-dialog-form"},r.a.createElement(pe.a.Item,{label:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438\u043b\u0438 E-Mail"},r.a.createElement(Ee.a,{showSearch:!0,style:{width:"100%"},optionFilterProp:"children",onChange:u,onSelect:o,onSearch:d,filterOption:!1,placeholder:"\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438\u043b\u0438 E-mail",value:g},h)),p&&r.a.createElement(pe.a.Item,{label:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f"},r.a.createElement(te.a.TextArea,{onChange:m,autoSize:{minRows:2,maxRows:6},value:f,placeholder:"\u0422\u0435\u043a\u0441\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f..."}))))))},rt=a(567);function st(e){return new Promise((function(t,a){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){return t(n.result)},n.onerror=function(e){return a(e)}}))}var ct=function(e){var t=e.attachments,a=e.removeAttachment,s=Object(n.useState)(!1),c=Object(b.a)(s,2),i=c[0],o=c[1],u=Object(n.useState)(""),l=Object(b.a)(u,2),d=l[0],m=l[1],p=Object(n.useState)(t),f=Object(b.a)(p,2),E=f[0],g=f[1];return Object(n.useEffect)((function(){g(t)}),[t]),r.a.createElement("div",{className:"clearfix"},r.a.createElement(rt.a,{action:"https://www.mocky.io/v2/5cc8019d300000980a055e76",listType:"picture-card",fileList:E,onPreview:function(e){return be.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.url||e.preview){t.next=4;break}return t.next=3,be.a.awrap(st(e.originFileObj));case 3:e.preview=t.sent;case 4:m(e.url||e.preview),o(!0);case 6:case"end":return t.stop()}}))},onChange:function(e){var t=e.fileList;return g({fileList:t})},onRemove:function(e){a(e)}})," ",r.a.createElement(de.a,{visible:i,footer:null,onCancel:function(){o(!1)}},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:d}))," ")},it=a(133),ot=a(134),ut=a(141),lt=a(135),dt=a(142),mt=a(572),pt=Object(et.g)((function(){return r.a.createElement(mt.a,{status:"500",subTitle:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a."})})),ft=function(e){function t(){var e,a;Object(it.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(ut.a)(this,(e=Object(lt.a)(t)).call.apply(e,[this].concat(r)))).state={errorIndicator:!1},a}return Object(dt.a)(t,e),Object(ot.a)(t,[{key:"render",value:function(){return this.state.errorIndicator?r.a.createElement(pt,null):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{errorIndicator:!0}}}]),t}(n.Component),Et=(n.Component,function(e){var t=e.touched,a=e.errors,n=e.handleChange,s=e.handleBlur,c=e.handleSubmit,o=e.isSubmitting;return e.isAuth?r.a.createElement(et.a,{to:"/"}):r.a.createElement("div",null," ",r.a.createElement("div",{className:"auth__top"},r.a.createElement("h2",null,"\u0412\u043e\u0439\u0442\u0438 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442"),r.a.createElement("p",null,"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u043e\u0439\u0434\u0438\u0442\u0435 \u0432 \u0441\u0432\u043e\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442")),r.a.createElement(_,null,r.a.createElement(pe.a,{onSubmit:c,className:"login-form"},r.a.createElement(fe,{errors:a,touched:t,placeholder:"E-mail",handleChange:n,handleBlur:s,type:"email",icon:"mail",id:"email"}),r.a.createElement(fe,{errors:a,touched:t,placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",handleChange:n,handleBlur:s,type:"password",icon:"lock",id:"password"}),r.a.createElement(pe.a.Item,null,r.a.createElement(v,{type:"primary",size:"large",onClick:c,loading:o,disabled:o},"\u0412\u043e\u0439\u0442\u0438 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442")),r.a.createElement(i.b,{className:"auth__register-link",to:"/signup"},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"))))}),gt=a(138),ht=function(e){var t=e.isAuth,a=e.errors,n=e.values,r={email:function(e){e?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e)||(a.email="\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u0430\u0434\u0440\u0435\u0441\u0441 \u043f\u043e\u0447\u0442\u044b"):a.email="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u043e\u0447\u0442\u0443"},password:function(e){e?e.length<6&&!t&&(a.password="\u0421\u043b\u0438\u0448\u043a\u043e\u043c \u043b\u0451\u0433\u043a\u0438\u0439 \u043f\u0430\u0440\u043e\u043b\u044c"):a.password="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c"},password_2:function(e){e!==n.password&&(a.password_2="\u041f\u0430\u0440\u043e\u043b\u0438 \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442")},fullname:function(e){e?e.length<4&&(a.fullname="\u0418\u043c\u044f \u0434\u043e\u043b\u0436\u043d\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043d\u0435 \u043c\u0435\u043d\u044c\u0448\u0435 4 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"):a.fullname="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0430\u0448\u0435 \u0438\u043c\u044f"}};Object.keys(n).forEach((function(e){return r[e]&&r[e](n[e])}))},vt=Object(gt.a)({mapPropsToValues:function(){return{email:"",password:""}},validate:function(e){var t={};return ht({isAuth:!0,errors:t,values:e}),t},handleSubmit:function(e,t){var a,n,r;return be.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return a=t.setSubmitting,n=t.props,s.prev=1,s.next=4,be.a.awrap(f.dispatch(Fe.fetchLoginData(e)));case 4:if(r=s.sent,a(!1),"success"!==r.status){s.next=16;break}return s.next=9,be.a.awrap(f.dispatch(Fe.fetchUserData()));case 9:if("success"!==s.sent.data.status){s.next=16;break}return s.next=13,be.a.awrap(f.dispatch({type:"USER:SET_IS_AUTH",payload:!0}));case 13:return s.next=15,be.a.awrap(f.dispatch({type:"INITIALIZED_SUCCESS"}));case 15:n.history.push("/");case 16:s.next=21;break;case 18:s.prev=18,s.t0=s.catch(1),console.log(s.t0);case 21:case"end":return s.stop()}}),null,null,[[1,18]])},displayName:"LoginForm"})(Et),_t=Object(o.b)((function(e){return{isAuth:e.user.isAuth}}))(vt),bt=function(e){var t=e.touched,a=e.errors,n=e.handleChange,s=e.handleBlur,c=e.handleSubmit,o=e.isSubmitting;return r.a.createElement("div",null," ",r.a.createElement("div",{className:"auth__top"},r.a.createElement("h2",null,"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"),r.a.createElement("p",null,"\u0414\u043b\u044f \u0432\u0445\u043e\u0434\u0430 \u0432 \u0447\u0430\u0442 \u0432\u0430\u043c \u043d\u0443\u0436\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f")),r.a.createElement(_,null,r.a.createElement(pe.a,{onSubmit:c,className:"login-form"},r.a.createElement(fe,{errors:a,touched:t,placeholder:"E-mail",handleChange:n,handleBlur:s,type:"email",icon:"mail",id:"email"}),r.a.createElement(fe,{errors:a,touched:t,placeholder:"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f",handleChange:n,handleBlur:s,type:"text",icon:"user",id:"fullname"}),r.a.createElement(fe,{errors:a,touched:t,placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",handleChange:n,handleBlur:s,type:"password",icon:"lock",id:"password"}),r.a.createElement(fe,{errors:a,touched:t,placeholder:"\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c",handleChange:n,handleBlur:s,type:"password",icon:"lock",id:"password_2"}),r.a.createElement(pe.a.Item,null,r.a.createElement(v,{disabled:o,type:"primary",size:"large",onClick:c},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f")),r.a.createElement(i.b,{className:"auth__register-link",to:"/signin"},"\u0412\u043e\u0439\u0442\u0438 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442"))))},St=Object(gt.a)({mapPropsToValues:function(){return{email:"",password:"",password_2:"",fullname:""}},validate:function(e){var t={};return ht({isAuth:!1,errors:t,values:e}),t},handleSubmit:function(e,t){var a,n,r,s,c;return be.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return a=t.setSubmitting,n=t.props,r=e.email,s=e.password,c=e.fullname,i.prev=2,i.next=5,be.a.awrap(f.dispatch(Fe.signUserUp({fullname:c,password:s,email:r})));case 5:"success"===i.sent.data.status&&n.history.push("/user/verify"),i.next=13;break;case 9:i.prev=9,i.t0=i.catch(2),console.log(i.t0),a(!1);case 13:case"end":return i.stop()}}),null,null,[[2,9]])},displayName:"RegisterForm"})(bt);function yt(e){var t=e.location.search.split("?hash=")[1],a=Object(n.useState)(null),s=Object(b.a)(a,2),c=s[0],o=s[1],u=Object(n.useState)(!1),l=Object(b.a)(u,2),d=l[0],m=l[1],p=Object(n.useState)(!1),f=Object(b.a)(p,2),g=f[0],h=f[1],v=function(e){var t=e.verified,a=e.hash,n=(e.loading,e.error);return a?t?{status:"success",title:"\u0413\u043e\u0442\u043e\u0432\u043e!",message:"\u0412\u0430\u0448 \u0430\u043a\u043a\u0430\u0443\u043d\u0442 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d",extra:[r.a.createElement(i.b,{to:"/signin",key:"123"},r.a.createElement(E.a,{type:"primary"},"\u0412\u0432\u043e\u0439\u0442\u0438 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442"))]}:n?{status:"error",title:"\u041e\u0448\u0438\u0431\u043a\u0430",message:"\u041d\u0435\u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c \u0430\u043a\u043a\u0430\u0443\u043d\u0442 "}:void 0:{status:"success",title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u0440\u043e\u0448\u043b\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e!",message:"\u0421\u0441\u044b\u043b\u043a\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430 \u043d\u0430 \u043f\u043e\u0447\u0442\u0443"}}({verified:c,hash:t,loading:d,error:g});return Object(n.useEffect)((function(){t&&Me(t).then((function(e){return be.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:m(!0),"success"===e.data.status&&(o(!0),m(!1));case 2:case"end":return t.stop()}}))})).catch((function(e){h(!0),m(!1)}))}),[t]),d||!v?r.a.createElement(ae.a,null):r.a.createElement(_,null,r.a.createElement(mt.a,{status:v.status,extra:v.extra,title:v.title,subTitle:v.message}))}a(560);var wt=function(){return r.a.createElement("section",{className:"auth"},r.a.createElement("div",{className:"auth__content"},r.a.createElement(et.d,null,r.a.createElement(et.b,{exact:!0,path:"/signup",component:St}),r.a.createElement(et.b,{exact:!0,path:"/user/verify",component:yt}),r.a.createElement(et.b,{path:["/","/signin"],component:_t}))))};a(561);var Ot=Object(et.g)(Object(o.b)((function(e){var t=e.user;return{isAuth:t.isAuth,fullname:t.data.user.fullname}}),Object(Ke.a)({},Ge,{},Fe))((function(e){var t=e.setCurrentDialog,a=e.signOut,s=e.isAuth,c=e.fullname;return Object(n.useEffect)((function(){return function(){e.history.push("/")}}),[]),Object(n.useEffect)((function(){var a=e.location.pathname.split("/").pop();24===a.length&&t(a)}),[e.location.pathname,t]),s&&r.a.createElement("section",{className:"home"},r.a.createElement("div",{className:"chat"},r.a.createElement(tt,null),r.a.createElement("div",{className:"chat__dialog"},r.a.createElement("div",{className:"chat__dialog-header"},r.a.createElement("div",null),r.a.createElement(Qe,null),r.a.createElement("div",null," ",r.a.createElement(z.a,{style:{fontSize:"20px",marginRight:"10px",color:"#389990",cursor:"pointer"},type:"logout",onClick:function(){window.confirm("".concat(c,", \u0432\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u043d\u044b \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0432\u044b\u0439\u0442\u0438 \u0438\u0437 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430?"))&&a()}}))),r.a.createElement(Je,null),r.a.createElement("div",{className:"chat__dialog-input"},r.a.createElement($e,null)))))})));var It=Object(o.b)((function(e){var t=e.user,a=e.app;return{isAuth:t.isAuth,isInitialized:a.isInitialized}}),Ze)((function(e){var t=e.isAuth,a=e.initializeApp,s=e.isInitialized;return Object(n.useEffect)((function(){a()}),[t,a]),s?r.a.createElement("div",{className:"wrapper"}," ",r.a.createElement(et.d,null,t&&r.a.createElement(et.b,{exact:!0,path:"/:dialog?/:id?",render:function(){return r.a.createElement(Ot,null)}}),r.a.createElement(et.b,{exact:!0,path:["/","/signin","/signup","/user/verify"],component:wt}),r.a.createElement(et.b,{render:function(){return r.a.createElement(mt.a,{status:"404",title:"404",subTitle:"Sorry, the page you visited does not exist."})}}))):r.a.createElement(ae.a,{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},size:"large",tip:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."})}));a(562);c.a.render(r.a.createElement(o.a,{store:f},r.a.createElement(i.a,null,r.a.createElement(ft,null,r.a.createElement(It,null)))),document.getElementById("root"))},61:function(e,t,a){"use strict";a.r(t),a.d(t,"SET_ITEMS",(function(){return s})),a.d(t,"SET_IS_LOADING",(function(){return c})),a.d(t,"ADD_MESSAGE",(function(){return i})),a.d(t,"REMOVE_MESSAGE",(function(){return o}));var n=a(84),r=a(19),s="MESSAGES:SET_ITEMS",c="MESSAGES:SET_IS_LOADING",i="MESSAGES:ADD_MESSAGE",o="MESSAGES:REMOVE_MESSAGE",u={items:[],isLoading:!1};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0,a=t.type,l=t.payload;switch(a){case s:return Object(r.a)({},e,{items:l});case c:return Object(r.a)({},e,{isLoading:l});case i:return Object(r.a)({},e,{items:[].concat(Object(n.a)(e.items),[l])});case o:return Object(r.a)({},e,{items:e.items.filter((function(e){return e._id!==l}))});default:return e}}},72:function(e,t,a){"use strict";a.r(t),a.d(t,"SET_ITEMS",(function(){return r})),a.d(t,"SET_CURRENT_DIALOG",(function(){return s})),a.d(t,"UPDATE_DIALOG",(function(){return c})),a.d(t,"SET_IS_LOADING",(function(){return i}));var n=a(19),r="DIALOGS:SET_ITEMS",s="DIALOGS:SET_CURRENT_DIALOG",c="DIALOGS:UPDATE_DIALOG",i="DIALOGS:SET_IS_LOADING",o={items:[],currentDialogId:null,isLoading:!1};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=arguments.length>1?arguments[1]:void 0,a=t.type,u=t.payload;switch(a){case r:return Object(n.a)({},e,{items:u});case s:return Object(n.a)({},e,{currentDialogId:u});case c:var l=e.items.map((function(e){return e._id===u._id&&(e=u),e}));return Object(n.a)({},e,{items:l});case i:return Object(n.a)({},e,{isLoading:u});default:return e}}},95:function(e,t,a){"use strict";a.r(t);var n=a(43);t.default=Object(n.c)(["user","dialogs","messages","app","attachments"].reduce((function(e,t){return e[t]=a(291)("./".concat(t)).default,e}),{}))},97:function(e,t,a){"use strict";a.r(t),a.d(t,"INITIALIZED_SUCCESS",(function(){return r}));var n=a(19),r="APP:INITIALIZED_SUCCESS",s={isInitialized:!1};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments.length>1?arguments[1]:void 0,a=t.type;t.payload;switch(a){case r:return Object(n.a)({},e,{isInitialized:!0});default:return e}}},98:function(e,t,a){"use strict";a.r(t),a.d(t,"SET_ATTACHMENTS",(function(){return r})),a.d(t,"REMOVE_ATTACHMENT",(function(){return s}));var n=a(19),r="ATTACHMENTS:SET_ATTACHMENTS",s="ATTACHMENTS:REMOVE_ATTACHMENT",c={items:[]};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,t=arguments.length>1?arguments[1]:void 0,a=t.type,i=t.payload;switch(a){case r:return Object(n.a)({},e,{items:i});case s:return Object(n.a)({},e,{items:e.items.filter((function(e){return e.uid!==i.uid}))});default:return e}}},99:function(e,t,a){"use strict";a.r(t),a.d(t,"SET_USER_DATA",(function(){return r})),a.d(t,"SET_IS_AUTH",(function(){return s}));var n=a(19),r="USER:SET_USER_DATA",s="USER:SET_IS_AUTH",c={data:null,isAuth:!!window.localStorage.token};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,t=arguments.length>1?arguments[1]:void 0,a=t.type,i=t.payload;switch(a){case r:return Object(n.a)({},e,{data:i});case s:return Object(n.a)({},e,{isAuth:i});default:return e}}}},[[284,1,2]]]);
//# sourceMappingURL=main.e8b03bd5.chunk.js.map