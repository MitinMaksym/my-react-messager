(this.webpackJsonpchat=this.webpackJsonpchat||[]).push([[0],{245:function(e,t,a){e.exports=a.p+"static/media/play.65f03140.svg"},246:function(e,t,a){e.exports=a.p+"static/media/wave.86c27fea.svg"},247:function(e,t,a){e.exports=a.p+"static/media/pause.a61933e8.svg"},249:function(e,t,a){e.exports=a.p+"static/media/readed.2da46147.svg"},250:function(e,t,a){e.exports=a.p+"static/media/noreaded.1456f013.svg"},278:function(e,t,a){e.exports=a(557)},285:function(e,t,a){},326:function(e,t,a){},327:function(e,t,a){},339:function(e,t,a){},341:function(e,t,a){},422:function(e,t,a){},428:function(e,t,a){},448:function(e,t,a){},452:function(e,t,a){},532:function(e,t){},535:function(e,t,a){},554:function(e,t,a){},555:function(e,t,a){},556:function(e,t,a){},557:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(4),c=a.n(s),i=a(27),o=a(24),l=a(43),u=a(242),d=a(20),m={isInitialized:!1},p=a(74),f={items:[],currentDialogId:"",isLoading:!1},g={items:[],isLoading:!1},E={data:null,isAuth:!!window.localStorage.token},h={items:[]},v=Object(l.c)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USERS:SET_USER_DATA":return Object(d.a)({},e,{data:t.payload});case"USERS:SET_IS_AUTH":return Object(d.a)({},e,{isAuth:t.payload});default:return e}},dialogs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"DIALOGS:SET_ITEMS":return Object(d.a)({},e,{items:t.payload});case"DIALOGS:ADD_NEW_DIALOG":return Object(d.a)({},e,{items:[].concat(Object(p.a)(e.items),[t.payload])});case"DIALOGS:SET_CURRENT_DIALOG":return Object(d.a)({},e,{currentDialogId:t.payload});case"DIALOGS:UPDATE_DIALOG":var a=e.items.map((function(e){return e._id===t.payload._id&&(e=t.payload),e}));return Object(d.a)({},e,{items:a});case"DIALOGS:SET_IS_LOADING":return Object(d.a)({},e,{isLoading:t.payload});default:return e}},messages:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MESSAGES:SET_ITEMS":return Object(d.a)({},e,{items:t.payload});case"MESSAGES:SET_IS_LOADING":return Object(d.a)({},e,{isLoading:t.payload});case"MESSAGES:ADD_MESSAGE":return Object(d.a)({},e,{items:[].concat(Object(p.a)(e.items),[t.payload])});case"MESSAGES:UPDATE_UNREAD_MESSAGES":var a=Object(p.a)(e.items),n=a.map((function(e,t){e.readed||(e=Object(d.a)({},e,{readed:!0}));return e}));return Object(d.a)({},e,{items:n});case"MESSAGES:REMOVE_MESSAGE":return Object(d.a)({},e,{items:e.items.filter((function(e){return e._id!==t.payload}))});default:return e}},app:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"APP:INITIALIZE_APP":return Object(d.a)({},e,{isInitialized:!0});default:return e}},attachments:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ATTACHMENTS:SET_ATTACHMENTS":return Object(d.a)({},e,{items:t.payload});case"ATTACHMENTS:REMOVE_ATTACHMENT":return Object(d.a)({},e,{items:e.items.filter((function(e){return e.uid!==t.payload.uid}))});default:return e}}}),b=[u.a],_=("object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):l.d)(l.a.apply(void 0,b)),S=Object(l.e)(v,_),y=a(62),O=a(2),w=a.n(O),A=(a(285),function(e){return r.a.createElement(y.a,Object.assign({},e,{className:w()("button",e.className,{"button--large":"large"===e.size})}))}),I=(a(326),function(e){var t=e.children,a=e.className;return r.a.createElement("div",{className:w()("block",a)},t)}),j=function(e){if(!e)return null;var t=e[0];return e.length&&"webm"===t.ext},D=a(558),x=(a(327),a(13)),N=a(245),M=a.n(N),T=a(246),L=a.n(T),k=a(247),R=a.n(k),C=function(e){var t=e.audioSrc,a=Object(n.useState)(!1),s=Object(x.a)(a,2),c=s[0],i=s[1],o=Object(n.useState)(0),l=Object(x.a)(o,2),u=l[0],d=l[1],m=Object(n.useState)(0),p=Object(x.a)(m,2),f=p[0],g=p[1],E=Object(n.useRef)(null);return Object(n.useEffect)((function(){E.current&&(E.current.addEventListener("playing",(function(){return i(!0)})),E.current.addEventListener("ended",(function(){i(!1),g(0),d(0)})),E.current.addEventListener("pause",(function(){return i(!1)})),E.current.addEventListener("timeupdate",(function(){var e=E.current&&E.current.duration||0;E.current&&(d(E.current.currentTime),g(E.current.currentTime/e*100))})))}),[]),r.a.createElement("div",{className:"message__audio"},r.a.createElement("audio",{src:t,ref:E,preload:"auto"}),r.a.createElement("div",{style:{width:f+"%"},className:"message__audio-progress"}),r.a.createElement("div",{className:"message__audio-info"},r.a.createElement("div",{className:"message__audio-btn"},r.a.createElement("button",{onClick:function(){E.current&&(c?E.current.pause():E.current.play())}},c?r.a.createElement("img",{src:R.a,alt:"Pause swg"}):r.a.createElement("img",{src:M.a,alt:"Play swg"}))),r.a.createElement("div",{className:"message__audio-wave"},r.a.createElement("img",{src:L.a,alt:"Wave svg"})),r.a.createElement("div",{className:"message__audio-duration"},function(e){var t=Math.floor(e/60),a=new Number((e%60).toFixed());return"".concat(t<10?"0":"").concat(t,":").concat(a<10?"0":"").concat(a)}(u))))},G=a(185).Emojione,U=function(e){var t=e.id,a=e.createdAt,n=e.text,s=e.user,c=e.date,i=e.isMe,o=e.attachments,l=e.isTyping,u=e.readed,d=e.setImageUrl,m=e.onDeleteMessage,p=function(e){d&&d(e)};return r.a.createElement("div",{className:w()("message",{"message--isme":i,"message--is-typing":l,"message--image":o&&1===o.length&&!n,"message--is-audio":j(o)})},r.a.createElement("div",{className:"message__content"},i&&void 0!==u&&r.a.createElement(te,{isMe:i,isReaded:u}),i&&r.a.createElement("div",{className:"message__icon-actions"},r.a.createElement(D.a,{content:r.a.createElement("div",null,r.a.createElement(y.a,{onClick:function(e){m&&t&&m(t)}},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435")),trigger:"click"},r.a.createElement(y.a,{type:"link",shape:"circle",icon:"ellipsis"}))),r.a.createElement("div",{className:"message__avatar"},r.a.createElement(B,{user:s})),r.a.createElement("div",{className:"message__info"}," ",(l||n)&&r.a.createElement("div",{className:"message__bubble"},n&&r.a.createElement("p",{className:"message__text"},r.a.createElement(G,{text:n})),l&&r.a.createElement("div",{className:"message__typing"},r.a.createElement("span",null),r.a.createElement("span",null),r.a.createElement("span",null))),o&&r.a.createElement("div",{className:"message__attachments"},o.map((function(e){return function(e){return"webm"!==e.ext?r.a.createElement("div",{key:e._id,className:"message__attachments-item"},e.url&&r.a.createElement("img",{src:e.url.replace(/http/,"https"),alt:e.filename,onClick:function(){e.url&&p(e.url)}})):r.a.createElement(C,{key:e._id,audioSrc:e.url?e.url:""})}(e)}))),c&&a&&r.a.createElement("span",{className:"message__date"},r.a.createElement(J,{date:new Date(a)})))))},P=a(121),V=a.n(P),z=function(e){var t=e.substr(11,14).split("").map((function(e){return(t=e).charCodeAt(0)>255?255:t.charCodeAt(0)<0?0:t.charCodeAt(0);var t})),a=Object(x.a)(t,3),n=a[0],r=a[1],s=a[2];return{color:V()({r:n,g:r,b:s}).lighten(10).saturate(15).toHexString(),colorLighten:V()({r:n,g:r,b:s}).lighten(30).saturate(30).toHexString()}},B=(a(339),function(e){var t=e.user;if(t.avatar)return r.a.createElement("img",{src:t.avatar,className:"avatar",alt:"Avatar ".concat(t.fullname)});var a=z(t._id),n=a.color,s=a.colorLighten,c=t.fullname[0].toUpperCase();return r.a.createElement("div",{style:{background:"linear-gradient(135deg, ".concat(n," 0%, ").concat(s," 96.52%)")},className:"avatar avatar--symbol"},c)}),F=a(274),H=a(171),W=a(8),Z=a(185).Emojione,X=function(e){var t,a=e._id,n=e.isMe,s=e.partner,c=e.lastMessage,o=e.author,l=e.currentDialogId,u=e.userId,d=n?s:o;return r.a.createElement(i.b,{to:"/dialog/".concat(a)},r.a.createElement("div",{className:w()("dialogs__item",{"dialogs__item--online":d.isOnline,"dialogs__item--active":l===a})},r.a.createElement("div",{className:"dialogs__item-avatar"},r.a.createElement(B,{user:d})),r.a.createElement("div",{className:"dialogs__item-info"},r.a.createElement("div",{className:"dialogs__item-info-top"},r.a.createElement("b",null,d.fullname),c&&r.a.createElement("span",null,(t=new Date(c.createdAt),Object(F.a)(new Date(t))?Object(H.a)(new Date(t),"HH:mm"):Object(H.a)(new Date(t),"dd.MM.yyyy")))),c&&r.a.createElement("div",{className:"dialogs__item-info-bottom"},r.a.createElement("p",null,function(e,t){var a="";return a=!e.text&&e.attachments?"\u043f\u0440\u0438\u043a\u0440\u0435\u043f\u043b\u0435\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b":e.text,r.a.createElement(Z,{text:"".concat(e.user._id===t?"\u0412\u044b: ":""," ").concat(a)})}(c,u)),r.a.createElement(te,{isMe:u===c.user._id,isReaded:c.readed}),c.user._id!==u&&!1===c.readed&&r.a.createElement("div",{className:"dialogs__item-info-bottom-count"},r.a.createElement(W.a,{type:"mail"}))))))},q=a(270),Y=a(271),J=function(e){var t=e.date;return r.a.createElement(n.Fragment,null,Object(q.a)(t,{addSuffix:!0,locale:Y.a}))},K=a(249),$=a.n(K),Q=a(250),ee=a.n(Q),te=(a(341),function(e){var t=e.isMe,a=e.isReaded;return r.a.createElement("div",null,t&&(a?r.a.createElement("img",{className:"message__icon-readed",src:$.a,alt:"Readed icon"}):r.a.createElement("img",{className:"message__icon-readed message__icon-readed--no",src:ee.a,alt:"No readed icon"})))}),ae=a(251),ne=a.n(ae),re=a(563),se=a(559),ce=a(84),ie=(a(422),function(e){var t=e.items,a=e.userId,n=e.onSearch,s=e.inputValue,c=e.isLoading,i=e.currentDialogId,o=re.a.Search;return r.a.createElement("div",{className:"dialogs"},r.a.createElement("div",{className:"dialogs__search"},r.a.createElement(o,{value:s,onChange:function(e){n(e.target.value)},placeholder:"\u041f\u043e\u0438\u0441\u043a \u0441\u0440\u0435\u0434\u0438 \u043a\u043e\u043d\u0442\u0430\u043a\u0442\u043e\u0432"})),r.a.createElement("div",null,c?r.a.createElement(se.a,{tip:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0438\u0430\u043b\u043e\u0433\u043e\u0432"}):t?t.length>0?ne()(t,["created_at"],["desc"]).map((function(e){return r.a.createElement(X,Object.assign({key:e._id,isMe:e.author._id===a,userId:a,currentDialogId:i},e))})):r.a.createElement(ce.a,{description:"\u041d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"}):null))}),oe=(a(428),function(e){var t=e.online,a=e.fullname;return r.a.createElement("div",{className:"chat__dialog-header-center"},r.a.createElement("b",{className:"chat__dialog-header-username"},a),r.a.createElement("div",{className:"chat__dialog-header-status"}),r.a.createElement("div",{className:w()("status",{"status--online":t})},t?"\u043e\u043d\u043b\u0430\u0439\u043d":"\u043e\u0444\u043b\u0430\u0439\u043d"))}),le=a(269),ue=(a(443),a(256)),de=(a(448),function(e){var t=e.value,a=e.setValue,s=e.toggleEmoji,c=e.emojiVisible,i=e.addEmoji,o=e.selectFile,l=e.attachments,u=e.removeAttachment,d=e.isDisabled,m=e.inputRef,p=e.handleSendMessage,f=e.onSendMessage,g=e.isRecording,E=e.onStopRecording,h=e.onRecord,v=e.isLoading;return r.a.createElement(n.Fragment,null,r.a.createElement("div",{ref:m,className:"chat-input"},r.a.createElement("div",null,r.a.createElement("div",{className:"chat-input__smile-btn"},r.a.createElement("div",{className:"chat-input__emoji-picker"},c&&r.a.createElement(le.a,{onSelect:i})),r.a.createElement(y.a,{onClick:s,type:"link",shape:"circle",icon:"smile"})),g?r.a.createElement("div",{className:"chat-input__record-status"},r.a.createElement("i",{className:"chat-input__record-status-bubble"}),"Recording...",r.a.createElement(y.a,{className:"stop-recording",type:"link",shape:"circle",icon:"close",onClick:E})):r.a.createElement(re.a.TextArea,{onChange:function(e){/^\s/.test(e.target.value)||a(e.target.value)},placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f",autoSize:{minRows:2,maxRows:8},allowClear:!0,value:t,onKeyUp:p,disabled:d}),r.a.createElement("div",{className:"chat-input__actions"},t||l.length||g?r.a.createElement(y.a,{disabled:d,onClick:f,size:"large",type:"link",icon:"right-circle"}):r.a.createElement("div",{className:"chat-input__record-btn"},v?r.a.createElement(W.a,{type:"loading"}):r.a.createElement(y.a,{onClick:h,type:"link",shape:"circle",icon:"audio",size:"large"})),r.a.createElement(ue.UploadField,{onFiles:o,containerProps:{className:"chat-input__actions-upload-btn"},uploadProps:{accept:".jpg,.jpeg,.png,.gif,.bmp",multiple:"multiple"}},r.a.createElement(y.a,{type:"link",shape:"circle",icon:"camera"}))))),r.a.createElement("div",null,r.a.createElement(it,{attachments:l,removeAttachment:u})))}),me=a(564),pe=a(257),fe=a.n(pe),ge=(a(452),function(e){var t,a=e.items,n=e.isLoading,s=e.boxRef,c=e.currentDialogId,i=e.userId,o=e.attachments,l=e.setImageUrl,u=e.showImage,d=e.setShowImage,m=e.imageUrl,p=e.dialogsItems,f=e.isTyping,g=e.onRemoveMessage,E=p&&fe()(p,{_id:c});E&&(t=E.partner.id===i?E.author:E.partner);return r.a.createElement("div",{className:w()("chat__dialog-messages",{"chat__dialog-messages-attachments":o.length})},r.a.createElement("div",{ref:s,className:w()("messages",{"messages--loading":n})},n?r.a.createElement(se.a,{size:"large",tip:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439..."}):a&&!n&&c?a.length>0?a.map((function(e){return r.a.createElement(U,Object.assign({id:e._id,key:e._id,alt:"User avatar",text:e.text,date:new Date,isMe:e.user._id===i},e,{isTyping:!1,setImageUrl:l,onDeleteMessage:g}))})):r.a.createElement(ce.a,{description:"\u0414\u0438\u0430\u043b\u043e\u0433 \u043f\u0443\u0441\u0442"}):r.a.createElement(ce.a,{description:"\u0412\u0438\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0438\u0430\u043b\u043e\u0433"})," ",f&&t&&!n&&r.a.createElement(U,{isTyping:!0,user:t})),m&&r.a.createElement(me.a,{visible:u,footer:null,onCancel:function(){d(!1),l("")}},r.a.createElement("img",{alt:"previewImg",style:{width:"100%"},src:m})))}),Ee=a(562),he=function(e,t,a){return t[e]?a[e]?"error":"success":""},ve=a(566),be=function(e){var t=e.type,a=e.message,n=e.description,r=e.duration;ve.a[t]({message:a,description:n,duration:r})},_e=function(e){var t=e.errors,a=e.type,n=e.icon,s=e.placeholder,c=e.handleChange,i=e.handleBlur,o=e.id,l=e.touched;return r.a.createElement(Ee.a.Item,{help:l[o]&&t[o],validateStatus:he(o,l,t),hasFeedback:!0}," ",r.a.createElement(re.a,{prefix:r.a.createElement(W.a,{type:n,style:{color:"rgba(0,0,0,.25)"}}),type:a,placeholder:s,id:o,onChange:c,onBlur:i}))},Se=a(5),ye=a.n(Se),Oe=a(65),we=a.n(Oe);we.a.defaults.baseURL="http://localhost:3003/",we.a.defaults.headers.common.token=window.localStorage.token;var Ae=we.a,Ie=function(){return Ae.get("dialogs").then((function(e){return e.data}))},je=function(e){var t;return ye.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,ye.a.awrap(Ae.post("dialogs",{partner:e.partner,text:e.text}));case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}))},De=function(e){var t;return ye.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,ye.a.awrap(Ae.get("messages?dialog="+e));case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}))},xe=function(e){return ye.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:Ae.post("messages",{text:e.text,attachments:e.attachments,dialog_id:e.currentDialogId});case 1:case"end":return t.stop()}}))},Ne=function(e){return ye.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ye.a.awrap(Ae.delete("messages?id="+e));case 2:case"end":return t.stop()}}))},Me=function(e){var t;return ye.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,ye.a.awrap(Ae.post("user/login",e));case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}))},Te=function(){var e;return ye.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ye.a.awrap(Ae.get("user/me"));case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}}))},Le=function(e){var t;return ye.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,ye.a.awrap(Ae.post("user/registration",e));case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}))},ke=function(e){var t;return ye.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,ye.a.awrap(Ae.get("user/verify?hash=".concat(e)));case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}))},Re=function(e){var t;return ye.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,ye.a.awrap(Ae.get("user/find?query=".concat(e)));case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}))},Ce=function(e){var t,a;return ye.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return(t=new FormData).append("file",e),n.next=4,ye.a.awrap(Ae.post("files",t,{headers:{"content-type":"multipart/form-data"}}));case 4:return a=n.sent,n.abrupt("return",a.data);case 6:case"end":return n.stop()}}))},Ge={setCurrentDialog:function(e){return{type:"DIALOGS:SET_CURRENT_DIALOG",payload:e}},setItems:function(e){return{type:"DIALOGS:SET_ITEMS",payload:e}},updateDialog:function(e){return{type:"DIALOGS:UPDATE_DIALOG",payload:e}},addNewDialog:function(e){return{type:"DIALOGS:ADD_NEW_DIALOG",payload:e}},setIsLoading:function(e){return{type:"DIALOGS:SET_IS_LOADING",payload:e}}},Ue=Ge,Pe={setMessages:function(e){return{type:"MESSAGES:SET_ITEMS",payload:e}},addMessage:function(e){return{type:"MESSAGES:ADD_MESSAGE",payload:e}},removeMessageById:function(e){return{type:"MESSAGES:REMOVE_MESSAGE",payload:e}},updateUnreadMessages:function(){return{type:"MESSAGES:UPDATE_UNREAD_MESSAGES"}},setIsLoading:function(e){return{type:"MESSAGES:SET_IS_LOADING",payload:e}}},Ve=Pe,ze={setAuth:function(e){return{type:"USERS:SET_IS_AUTH",payload:e}},setUserData:function(e){return{type:"USERS:SET_USER_DATA",payload:e}}},Be=function(){return function(e,t){var a;return ye.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ye.a.awrap(Te());case 3:"success"===(a=t.sent).status&&(e(ze.setUserData(a.user)),e(ze.setAuth(!0))),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),403===t.t0.response.status?(delete window.localStorage.token,we.a.defaults.headers.common.token="",e(ze.setAuth(!1))):(e(ze.setAuth(!1)),console.log(t.t0));case 10:case"end":return t.stop()}}),null,null,[[0,7]])}},Fe=function(e){var t,a;return ye.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,ye.a.awrap(Me(e));case 3:if("success"!==(t=n.sent).status){n.next=10;break}return a=t.token,window.localStorage.token=a,we.a.defaults.headers.common.token=a,be({type:"success",message:"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f \u043f\u0440\u043e\u0439\u0448\u043b\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e!",description:"",duration:1}),n.abrupt("return",t);case 10:n.next=15;break;case 12:n.prev=12,n.t0=n.catch(0),404===n.t0.response.status?be({type:"error",message:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438",description:"\u0422\u0430\u043a\u043e\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d",duration:1}):401===n.t0.response.status?be({type:"error",message:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438",description:"\u0412\u0430\u0448 \u0430\u043a\u043a\u0430\u0443\u043d\u0442 \u043d\u0435 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d",duration:1}):(delete window.localStorage.token,we.a.defaults.headers.common.token="",be({type:"error",message:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438",description:"\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043b\u043e\u0433\u0438\u043d \u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c",duration:1}));case 15:case"end":return n.stop()}}),null,null,[[0,12]])},He={initializeAppAC:function(){return{type:"APP:INITIALIZE_APP"}}},We=He,Ze={setAttachments:function(e){return{type:"ATTACHMENTS:SET_ATTACHMENTS",payload:e}},removeAttachment:function(e){return{type:"ATTACHMENTS:REMOVE_ATTACHMENT",payload:e}}},Xe=a(262),qe=a.n(Xe)()("http://localhost:3003/"),Ye=Object(o.b)((function(e){return{items:e.dialogs.items,isLoading:e.dialogs.isLoading,userId:e.user.data._id,currentDialogId:e.dialogs.currentDialogId}}),{fetchDialogs:function(){return function(e){var t;return ye.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return e(Ge.setIsLoading(!0)),a.next=3,ye.a.awrap(Ie());case 3:t=a.sent,e(Ge.setItems(t)),e(Ge.setIsLoading(!1));case 6:case"end":return a.stop()}}))}},addNewDialog:Ue.addNewDialog,updateDialog:Ue.updateDialog})((function(e){var t=e.items,a=e.isLoading,s=e.userId,c=e.fetchDialogs,i=e.currentDialogId,o=e.addNewDialog,l=e.updateDialog,u=Object(n.useState)(""),d=Object(x.a)(u,2),m=d[0],p=d[1],f=Object(n.useState)(Array.from(t)),g=Object(x.a)(f,2),E=g[0],h=g[1],v=function(e){console.log(e),o(e)};return Object(n.useEffect)((function(){h(t)}),[t]),Object(n.useEffect)((function(){return c(),qe.emit("joinUser",{userId:s}),qe.on("SERVER:ADD-NEW-DIALOG",v),qe.on("SERVER:UPDATE-DIALOG",l),function(){qe.removeListener("SERVER:ADD-NEW-DIALOG",v),qe.removeListener("SERVER:UPDATE-DIALOG",l)}}),[]),r.a.createElement(ie,{items:E,onSearch:function(e){p(e),h(t.filter((function(t){return(s===t.author._id?t.partner:t.author).fullname.toLowerCase().indexOf(e)>=0})))},inputValue:m,isLoading:a,userId:s,currentDialogId:i})})),Je=Object(n.memo)((function(e){var t=e.items,a=e.fetchMessages,s=e.currentDialogId,c=e.isLoading,i=e.addMessage,o=e.attachments,l=e.userId,u=e.dialogsItems,d=e.updateUnreadMessages,m=e.removeMessageById,p=Object(n.useState)(""),f=Object(x.a)(p,2),g=f[0],E=f[1],h=Object(n.useState)(!1),v=Object(x.a)(h,2),b=v[0],_=v[1],S=Object(n.useState)(!1),y=Object(x.a)(S,2),O=y[0],w=y[1],A=null,I=function(e){l!==e&&(w(!0),clearInterval(A),A=setTimeout((function(){w(!1)}),3e3))},j=function(e){e.dialog._id===s&&e.user._id!==l&&De(s),i(e)},D=function(e){var t=e.user;l!==t&&(console.log("updateUnread"),d())},N=function(e){m(e._id)},M=Object(n.useCallback)((function(e){setTimeout((function(){null!==e&&e.scrollTo(0,99999)}))}),[t]);return Object(n.useEffect)((function(){g&&_(!0)}),[g]),Object(n.useEffect)((function(){return s&&a(s),qe.emit("joinRoom",s),qe.on("SERVER:NEW-MESSAGE",j),qe.on("SERVER:DIALOGS:TYPING",I),qe.on("SERVER:UPDATE-UNREAD-MSG",D),qe.on("SERVER:DELETE_MESSAGE",N),function(){qe.removeListener("SERVER:NEW-MESSAGE",j),qe.removeListener("SERVER:DIALOGS:TYPING",I),qe.removeListener("SERVER:UPDATE-UNREAD-MSG",D),qe.removeListener("SERVER:DELETE_MESSAGE",N),qe.emit("leaveRoom",s),console.log("messages unmounting")}}),[s]),s?r.a.createElement(ge,{boxRef:M,items:t,isLoading:c,currentDialogId:s,attachments:o,setImageUrl:E,showImage:b,setShowImage:_,imageUrl:g,userId:l,dialogsItems:u,isTyping:O,onRemoveMessage:function(e){Ne(e)}}):r.a.createElement(ce.a,{description:"\u0412\u0438\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0438\u0430\u043b\u043e\u0433"})})),Ke=Object(o.b)((function(e){return{currentDialogId:e.dialogs.currentDialogId,isLoading:e.messages.isLoading,items:e.messages.items,attachments:e.attachments.items,userId:e.user.data?e.user.data._id:"",dialogsItems:e.dialogs.items}}),{fetchMessages:function(e){return function(t){var a;return ye.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t(Pe.setIsLoading(!0)),n.next=3,ye.a.awrap(De(e));case 3:a=n.sent,t(Pe.setMessages(a)),t(Pe.setIsLoading(!1));case 6:case"end":return n.stop()}}))}},addMessage:Ve.addMessage,updateUnreadMessages:Ve.updateUnreadMessages,removeMessageById:Ve.removeMessageById})(Je),$e=Object(o.b)((function(e){return{currentDialogId:e.dialogs.currentDialogId,attachments:e.attachments.items,userId:e.user.data?e.user.data._id:""}}),{setAttachments:Ze.setAttachments,removeAttachment:Ze.removeAttachment})((function(e){var t=e.currentDialogId,a=e.setAttachments,s=e.removeAttachment,c=e.attachments,i=e.userId,o=Object(n.useState)(""),l=Object(x.a)(o,2),u=l[0],d=l[1],m=Object(n.useState)(!1),f=Object(x.a)(m,2),g=f[0],E=f[1],h=Object(n.useState)(!1),v=Object(x.a)(h,2),b=v[0],_=v[1],S=Object(n.useState)(!1),y=Object(x.a)(S,2),O=y[0],w=y[1],A=Object(n.useState)(!1),I=Object(x.a)(A,2),j=I[0],D=I[1],N=Object(n.useState)(null),M=Object(x.a)(N,2),T=M[0],L=M[1];window.navigator.getUserMedia=window.navigator.getUserMedia||window.navigator.mozGetUserMedia||window.navigator.msGetUserMedia||window.navigator.webkitGetUserMedia;var k=function(e){var t=new MediaRecorder(e);L(t),t.start(),t.onstart=function(){w(!0)},t.onstop=function(){w(!1)},t.ondataavailable=function(e){var t=new File([e.data],"audio.webm");E(!0),Ce(t).then((function(e){"success"===e.status&&e.file._id&&C(e.file._id).then((function(){E(!1)}))}))}},R=function(e){throw new Error(e.toString())},C=function(e){return xe({text:"",currentDialogId:t,attachments:[e]})},G=function(e){O&&T?T.stop():(u||c.length)&&(xe({text:u,currentDialogId:t,attachments:c.map((function(e){return e.uid?e.uid:""}))}),d(""),a([]))},U=function(e,t){t&&!t.contains(e.target)&&_(!1)},P=Object(n.useCallback)((function(e){if(e){var t=e.offsetHeight+40+93.5;c.length>0&&(t+=112);var a=document.querySelector(".chat__dialog-messages");a&&(a.style.height="calc(100% - ".concat(t,"px)"),0!==u.length||c.length||(a.style.height="calc(100% - 185.5px)"))}}),[u,c]);return Object(n.useEffect)((function(){var e=document.querySelector(".chat-input__smile-btn");return document.addEventListener("click",(function(t){return U(t,e)})),function(){document.removeEventListener("click",(function(t){U(t,e)}))}}),[t]),t?r.a.createElement(de,{inputRef:P,value:u,setValue:d,toggleEmoji:function(){_(!b)},emojiVisible:b,addEmoji:function(e){d(u+e.native)},selectFile:function(e){var t,n,r;return ye.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:t=c.length?c:[],n=function(n){var r,s;return ye.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return r=e[n],s=Math.floor(1e3*Math.random()).toString(),t=[].concat(Object(p.a)(t),[{uid:s,name:r.name,status:"done",url:"https://cdn.lowgif.com/small/dc86e54ceca03be4-loading-spinner-animated-gif-83320-mediabin.gif"}]),a(t),D(!0),c.next=7,ye.a.awrap(Ce(r).then((function(e){"success"===e.status&&(t=t.map((function(t){return t.uid===s&&e.file.url?{uid:e.file._id,name:e.file.filename,status:"done",url:e.file.url.replace(/http/,"https")}:t})))})));case 7:case"end":return c.stop()}}))},r=0;case 3:if(!(r<e.length)){s.next=9;break}return s.next=6,ye.a.awrap(n(r));case 6:r++,s.next=3;break;case 9:a(t),D(!1);case 11:case"end":return s.stop()}}))},attachments:c,removeAttachment:s,isDisabled:j,handleSendMessage:function(e){qe.emit("DIALOGS:TYPING",{currentDialogId:t,userId:i}),(u.length||c.length)&&13===e.keyCode&&G()},onSendMessage:G,isRecording:O,onStopRecording:function(){w(!1)},onRecord:function(){navigator.getUserMedia&&navigator.getUserMedia({audio:!0},k,R)},isLoading:g}):null})),Qe=Object(o.b)((function(e){var t=e.dialogs,a=e.user;return{currentDialogId:t.currentDialogId,dialogs:t.items,userId:a.data?a.data._id:""}}))((function(e){var t=e.currentDialogId,a=e.dialogs,n=e.userId;if(a.length<1||!t)return null;var s=a.filter((function(e){return e._id===t}))[0];if(s){var c=n===s.author._id?s.partner:s.author;return r.a.createElement(oe,{online:c.isOnline,fullname:c.fullname})}return null})),et=a(63),tt=Object(et.g)(Object(o.b)((function(e){return{userId:e.user.data?e.user.data._id:""}}))((function(e){var t=Object(n.useState)(!1),a=Object(x.a)(t,2),s=a[0],c=a[1],i=Object(n.useState)(!1),o=Object(x.a)(i,2),l=o[0],u=o[1],d=Object(n.useState)([]),m=Object(x.a)(d,2),p=m[0],f=m[1],g=Object(n.useState)(""),E=Object(x.a)(g,2),h=E[0],v=E[1],b=Object(n.useState)(""),_=Object(x.a)(b,2),S=_[0],y=_[1],O=Object(n.useState)(""),w=Object(x.a)(O,2),A=w[0],I=w[1];return r.a.createElement(rt,{modalText:"",userId:e.userId,isLoading:l,visible:s,showModal:function(){c(!0)},handleCancel:function(){c(!1),I(""),y(""),f([])},handleOk:function(){var t;return ye.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return u(!0),v(""),I(""),f([]),y(""),u(!1),c(!1),u(!1),c(!1),a.prev=9,a.next=12,ye.a.awrap(je({partner:S,text:h}));case 12:(t=a.sent)&&"success"===t.status&&e.history.push("/dialog/".concat(t.dialog._id)),a.next=19;break;case 16:a.prev=16,a.t0=a.catch(9),403===a.t0.response.status?be({type:"error",message:"\u0422\u0430\u043a\u043e\u0439 \u0434\u0438\u0430\u043b\u043e\u0433 \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442",description:"",duration:1}):be({type:"error",message:"\u041e\u0448\u0438\u0431\u043a\u0430",description:"",duration:1});case 19:case"end":return a.stop()}}),null,null,[[9,16]])},onInputSelect:function(e){y(e)},users:p,onSearch:function(e){var t;return ye.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,ye.a.awrap(Re(e));case 3:"success"===(t=a.sent).status&&f(t.users),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),console.error(a.t0);case 10:case"end":return a.stop()}}),null,null,[[0,7]])},onAddNewMessage:function(e){v(e.target.value)},partner:S,newMessageText:h,selectedInputValue:A,onInputChange:function(e){I(e)}})}))),at=a(560),nt=(a(535),at.a.Option),rt=function(e){var t=e.isLoading,a=e.visible,n=e.modalText,s=e.showModal,c=e.handleCancel,i=e.handleOk,o=e.onInputSelect,l=e.onInputChange,u=e.users,d=e.onSearch,m=e.onAddNewMessage,p=e.partner,f=e.newMessageText,g=e.selectedInputValue,E=u.map((function(e){return r.a.createElement(nt,{key:e._id},e.fullname)}));return r.a.createElement("div",{className:"chat__sidebar"},r.a.createElement("div",{className:"chat__sidebar-header"},r.a.createElement("div",null,r.a.createElement(W.a,{type:"team"}),r.a.createElement("span",null,"\u0421\u043f\u0438\u0441\u043e\u043a \u0434\u0438\u0430\u043b\u043e\u0433\u043e\u0432")),r.a.createElement(y.a,{onClick:s,type:"link",shape:"circle",icon:"form"})),r.a.createElement("div",{className:"chat__sidebar-dialogs"},r.a.createElement(Ye,null)),r.a.createElement("div",null,r.a.createElement(me.a,{title:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0434\u0438\u0430\u043b\u043e\u0433",visible:a,confirmLoading:t,onCancel:c,footer:[r.a.createElement(y.a,{key:"back",onClick:c},"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"),r.a.createElement(y.a,{disabled:!f,key:"submit",type:"primary",loading:t,onClick:i},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c")]},r.a.createElement("p",null,n),r.a.createElement(Ee.a,{className:"add-dialog-form"},r.a.createElement(Ee.a.Item,{label:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438\u043b\u0438 E-Mail"},r.a.createElement(at.a,{showSearch:!0,style:{width:"100%"},optionFilterProp:"children",onChange:l,onSelect:o,onSearch:d,filterOption:!1,placeholder:"\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438\u043b\u0438 E-mail",value:g},E)),p&&r.a.createElement(Ee.a.Item,{label:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f"},r.a.createElement(re.a.TextArea,{onChange:m,autoSize:{minRows:2,maxRows:6},value:f,placeholder:"\u0422\u0435\u043a\u0441\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f..."}))))))},st=a(561);function ct(e){return new Promise((function(t,a){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){return t(n.result)},n.onerror=function(e){return a(e)}}))}var it=function(e){var t=e.attachments,a=e.removeAttachment,s=Object(n.useState)(!1),c=Object(x.a)(s,2),i=c[0],o=c[1],l=Object(n.useState)(""),u=Object(x.a)(l,2),d=u[0],m=u[1],p=Object(n.useState)(t),f=Object(x.a)(p,2),g=f[0],E=f[1];return Object(n.useEffect)((function(){E(t)}),[t]),r.a.createElement("div",{className:"clearfix"},r.a.createElement(st.a,{action:"https://www.mocky.io/v2/5cc8019d300000980a055e76",listType:"picture-card",fileList:g,onPreview:function(e){return ye.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.url||e.preview){t.next=4;break}return t.next=3,ye.a.awrap(ct(e.originFileObj));case 3:e.preview=t.sent;case 4:m(e.url||e.preview),o(!0);case 6:case"end":return t.stop()}}))},onChange:function(e){!function(e){E(e.fileList)}(e)},onRemove:function(e){a(e)}})," ",r.a.createElement(me.a,{visible:i,footer:null,onCancel:function(){o(!1)}},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:d}))," ")},ot=a(264),lt=a(265),ut=a(273),dt=a(266),mt=a(276),pt=a(565),ft=Object(et.g)((function(){return r.a.createElement(pt.a,{status:"500",subTitle:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a."})})),gt=function(e){function t(){var e,a;Object(ot.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(ut.a)(this,(e=Object(dt.a)(t)).call.apply(e,[this].concat(r)))).state={errorIndicator:!1},a}return Object(mt.a)(t,e),Object(lt.a)(t,[{key:"componentDidCatch",value:function(){this.setState({errorIndicator:!0})}},{key:"render",value:function(){return this.state.errorIndicator?r.a.createElement(ft,null):this.props.children}}]),t}(n.Component),Et=function(e){var t=e.touched,a=e.errors,n=e.handleChange,s=e.handleBlur,c=e.handleSubmit,o=e.isSubmitting;return e.isAuth?r.a.createElement(et.a,{to:"/"}):r.a.createElement("div",null," ",r.a.createElement("div",{className:"auth__top"},r.a.createElement("h2",null,"\u0412\u043e\u0439\u0442\u0438 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442"),r.a.createElement("p",null,"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u043e\u0439\u0434\u0438\u0442\u0435 \u0432 \u0441\u0432\u043e\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442")),r.a.createElement(I,null,r.a.createElement(Ee.a,{onSubmit:c,className:"login-form"},r.a.createElement(_e,{errors:a,touched:t,placeholder:"E-mail",handleChange:n,handleBlur:s,type:"email",icon:"mail",id:"email"}),r.a.createElement(_e,{errors:a,touched:t,placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",handleChange:n,handleBlur:s,type:"password",icon:"lock",id:"password"}),r.a.createElement(Ee.a.Item,null,r.a.createElement(A,{type:"primary",size:"large",onClick:c,loading:o,disabled:o},"\u0412\u043e\u0439\u0442\u0438 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442")),r.a.createElement(i.b,{className:"auth__register-link",to:"/signup"},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"))))},ht=a(129),vt=function(e){var t=e.isAuth,a=e.errors,n=e.values,r={email:function(e){e?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e)||(a.email="\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u0430\u0434\u0440\u0435\u0441\u0441 \u043f\u043e\u0447\u0442\u044b"):a.email="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u043e\u0447\u0442\u0443"},password:function(e){e?e.length<6&&!t&&(a.password="\u0421\u043b\u0438\u0448\u043a\u043e\u043c \u043b\u0451\u0433\u043a\u0438\u0439 \u043f\u0430\u0440\u043e\u043b\u044c"):a.password="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c"},password_2:function(e){e!==n.password&&(a.password_2="\u041f\u0430\u0440\u043e\u043b\u0438 \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442")},fullname:function(e){e?e.length<4&&(a.fullname="\u0418\u043c\u044f \u0434\u043e\u043b\u0436\u043d\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043d\u0435 \u043c\u0435\u043d\u044c\u0448\u0435 4 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"):a.fullname="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0430\u0448\u0435 \u0438\u043c\u044f"}};Object.keys(n).forEach((function(e){return r[e]&&r[e](n[e])}))},bt=Object(ht.a)({mapPropsToValues:function(){return{email:"",password:""}},validate:function(e){var t={};return vt({isAuth:!0,errors:t,values:e}),t},handleSubmit:function(e,t){var a;return ye.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,ye.a.awrap(Fe(e));case 3:a=n.sent,t.setSubmitting(!1),a&&"success"===a.status&&(S.dispatch(Be()),S.dispatch(We.initializeAppAC())),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),console.log(n.t0);case 11:case"end":return n.stop()}}),null,null,[[0,8]])},displayName:"LoginForm"})(Et),_t=Object(o.b)((function(e){return{isAuth:e.user.isAuth}}))(bt),St=function(e){var t=e.touched,a=e.errors,n=e.handleChange,s=e.handleBlur,c=e.handleSubmit,o=e.isSubmitting;return r.a.createElement("div",null," ",r.a.createElement("div",{className:"auth__top"},r.a.createElement("h2",null,"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"),r.a.createElement("p",null,"\u0414\u043b\u044f \u0432\u0445\u043e\u0434\u0430 \u0432 \u0447\u0430\u0442 \u0432\u0430\u043c \u043d\u0443\u0436\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f")),r.a.createElement(I,null,r.a.createElement(Ee.a,{onSubmit:c,className:"login-form"},r.a.createElement(_e,{errors:a,touched:t,placeholder:"E-mail",handleChange:n,handleBlur:s,type:"email",icon:"mail",id:"email"}),r.a.createElement(_e,{errors:a,touched:t,placeholder:"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f",handleChange:n,handleBlur:s,type:"text",icon:"user",id:"fullname"}),r.a.createElement(_e,{errors:a,touched:t,placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",handleChange:n,handleBlur:s,type:"password",icon:"lock",id:"password"}),r.a.createElement(_e,{errors:a,touched:t,placeholder:"\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c",handleChange:n,handleBlur:s,type:"password",icon:"lock",id:"password_2"}),r.a.createElement(Ee.a.Item,null,r.a.createElement(A,{disabled:o,type:"primary",size:"large",onClick:c},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f")),r.a.createElement(i.b,{className:"auth__register-link",to:"/signin"},"\u0412\u043e\u0439\u0442\u0438 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442"))))},yt=Object(ht.a)({mapPropsToValues:function(){return{email:"",password:"",password_2:"",fullname:""}},validate:function(e){var t={};return vt({isAuth:!1,errors:t,values:e}),t},handleSubmit:function(e,t){var a,n,r,s,c;return ye.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(a=t.setSubmitting,n=t.props,r=e.email,s=e.password,c=e.fullname,i.prev=2,!c){i.next=8;break}return i.next=6,ye.a.awrap(Le({email:r,password:s,fullname:c}));case 6:"error"!==i.sent.status&&n.history.push("/user/verify");case 8:i.next=14;break;case 10:i.prev=10,i.t0=i.catch(2),400===i.t0.response.status?be({type:"error",message:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438",description:"\u0422\u0430\u043a\u043e\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0443\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d",duration:1}):be({type:"error",message:"Server Error",description:"Something went wrong",duration:1}),a(!1);case 14:case"end":return i.stop()}}),null,null,[[2,10]])},displayName:"RegisterForm"})(St),Ot=function(e){console.log(e);var t=e.location.search.split("?hash=")[1],a=Object(n.useState)(null),s=Object(x.a)(a,2),c=s[0],o=s[1],l=Object(n.useState)(!1),u=Object(x.a)(l,2),d=u[0],m=u[1],p=Object(n.useState)(!1),f=Object(x.a)(p,2),g=f[0],E=f[1],h=function(e){var t=e.verified,a=e.hash,n=e.error;return a?t?{status:"success",title:"\u0413\u043e\u0442\u043e\u0432\u043e!",message:"\u0412\u0430\u0448 \u0430\u043a\u043a\u0430\u0443\u043d\u0442 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d",extra:[r.a.createElement(i.b,{to:"/signin",key:"123"},r.a.createElement(y.a,{type:"primary"},"\u0412\u0432\u043e\u0439\u0442\u0438 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442"))]}:n?{status:"error",title:"\u041e\u0448\u0438\u0431\u043a\u0430",message:"\u041d\u0435\u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c \u0430\u043a\u043a\u0430\u0443\u043d\u0442 "}:void 0:{status:"success",title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u0440\u043e\u0448\u043b\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e!",message:"\u0421\u0441\u044b\u043b\u043a\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430 \u043d\u0430 \u043f\u043e\u0447\u0442\u0443"}}({verified:c,hash:t,error:g});return Object(n.useEffect)((function(){t&&ke(t).then((function(e){return ye.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:m(!0),"success"===e.status&&(o(!0),m(!1));case 2:case"end":return t.stop()}}))})).catch((function(e){E(!0),m(!1)}))}),[t]),d||!h?r.a.createElement(se.a,null):r.a.createElement(I,null,r.a.createElement(pt.a,{status:h.status,extra:h.extra,title:h.title,subTitle:h.message}))},wt=(a(554),function(){return r.a.createElement("section",{className:"auth"},r.a.createElement("div",{className:"auth__content"},r.a.createElement(et.d,null,r.a.createElement(et.b,{exact:!0,path:"/signup",component:yt}),r.a.createElement(et.b,{exact:!0,path:"/user/verify",component:Ot}),r.a.createElement(et.b,{path:["/","/signin"],component:_t}))))}),At=(a(555),Object(et.g)(Object(o.b)((function(e){var t=e.user;return{fullname:t.data?t.data.fullname:"",userId:t.data?t.data._id:""}}),{setCurrentDialog:Ue.setCurrentDialog,setDialogsItems:Ue.setItems,signOut:function(){return function(e){return ye.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:e(ze.setAuth(!1)),e(ze.setUserData(null)),delete window.localStorage.token;case 3:case"end":return t.stop()}}))}},setMessagesItems:Ve.setMessages})((function(e){var t=e.setCurrentDialog,a=e.setDialogsItems,s=e.setMessagesItems,c=e.fullname,i=e.signOut;return Object(n.useEffect)((function(){return function(){e.history.push("/")}}),[]),Object(n.useEffect)((function(){var a=e.location.pathname.split("/").pop();a&&24===a.length&&t(a)}),[e.location.pathname,t]),r.a.createElement("section",{className:"home"},r.a.createElement("div",{className:"chat"},r.a.createElement(tt,null),r.a.createElement("div",{className:"chat__dialog"},r.a.createElement("div",{className:"chat__dialog-header"},r.a.createElement("div",null),r.a.createElement(Qe,null),r.a.createElement("div",null," ",r.a.createElement(W.a,{style:{fontSize:"20px",marginRight:"10px",color:"#389990",cursor:"pointer"},type:"logout",onClick:function(){window.confirm("".concat(c,", \u0432\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u043d\u044b \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0432\u044b\u0439\u0442\u0438 \u0438\u0437 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430?"))&&(i(),a([]),s([]),t(""))}}))),r.a.createElement(Ke,null),r.a.createElement("div",{className:"chat__dialog-input"},r.a.createElement($e,null)))))})))),It=Object(o.b)((function(e){return{isAuth:e.user.isAuth,isInitialized:e.app.isInitialized}}),{initializeApp:function(){return function(e,t){var a;return ye.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t().user.isAuth){n.next=8;break}return a=e(Be()),n.next=5,ye.a.awrap(Promise.all([a]));case 5:e(He.initializeAppAC()),n.next=9;break;case 8:e(He.initializeAppAC());case 9:case"end":return n.stop()}}))}}})((function(e){var t=e.isAuth,a=e.initializeApp,s=e.isInitialized;return Object(n.useEffect)((function(){a()}),[t,a]),s?r.a.createElement("div",{className:"wrapper"}," ",r.a.createElement(et.d,null,t&&r.a.createElement(et.b,{exact:!0,path:"/:dialog?/:id?",render:function(){return r.a.createElement(At,null)}}),r.a.createElement(et.b,{exact:!0,path:["/","/signin","/signup","/user/verify"],component:wt}),r.a.createElement(et.b,{render:function(){return r.a.createElement(pt.a,{status:"404",title:"404",subTitle:"Sorry, the page you visited does not exist."})}}))):r.a.createElement(se.a,{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},size:"large",tip:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."})}));a(556);c.a.render(r.a.createElement(o.a,{store:S},r.a.createElement(i.a,null,r.a.createElement(gt,null,r.a.createElement(It,null)))),document.getElementById("root"))}},[[278,1,2]]]);
//# sourceMappingURL=main.2e6eb543.chunk.js.map