{"version":3,"sources":["assets/img/play.svg","assets/img/wave.svg","assets/img/pause.svg","assets/img/readed.svg","assets/img/noreaded.svg","redux/reduces sync /^/.*$","redux/store.js","components/Button/index.js","components/Block/index.js","utils/helpers/isAudio.js","utils/helpers/createAvatarFromHash.js","components/Avatar/index.js","components/Message/index.js","utils/helpers/convertCurentTime.js","components/DialogItem/index.js","components/Time/index.js","components/IconReaded/index.js","components/Dialogs/index.js","components/Status/index.js","components/ChatInput/index.js","components/Messages/index.js","utils/helpers/validateField.js","utils/helpers/openNotification.js","components/FormField/index.js","core/socket.js","core/axios.js","utils/api/dialogs.js","utils/api/messages.js","utils/api/user.js","utils/api/files.js","redux/actions/dialogs.js","redux/actions/messages.js","redux/actions/user.js","redux/actions/app.js","redux/actions/attachments.js","containers/Dialogs.js","containers/Messages.js","containers/ChatInput.js","containers/Status.js","containers/Sidebar.js","components/Sidebar/index.js","components/UploadFiles/index.js","components/ErrorIndicator/index.js","components/ErrorBoundry/index.js","modules/LoginForm/components/LoginForm.jsx","components/ErrorButton/index.js","utils/validations.js","modules/LoginForm/containers/LoginForm.js","modules/LoginForm/index.js","modules/RegisterForm/components/RegisterForm.jsx","modules/RegisterForm/index.js","modules/RegisterForm/containers/RegisterForm.js","pages/Auth/components/CheckEmailInfo.js","pages/Auth/index.js","pages/Home/index.js","App.js","index.js","redux/reduces/dialogs.js","redux/reduces/messages.js","redux/reduces/index.js","redux/reduces/app.js","redux/reduces/attachments.js","redux/reduces/user.js"],"names":["module","exports","map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","middleware","thunk","enhancer","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","applyMiddleware","store","createStore","rootReducer","Button","props","className","classnames","size","Block","children","attachments","file","length","ext","createAvatarFromHash","hash","substr","split","item","index","charCodeAt","r","g","b","color","tinycolor","lighten","saturate","toHexString","colorLighten","Avatar","user","avatar","src","alt","fullname","_id","firstChar","toUpperCase","style","background","Emoji","require","Emojione","MessageAudio","audioSrc","useState","isPlaying","setIsPlaying","currentTime","setCurrentTime","progress","setProgress","audioEl","useRef","useEffect","setTimeout","console","log","current","duration","addEventListener","ref","preload","width","onClick","pause","play","pauseSvg","playSvg","waveSvg","number","mins","Math","floor","secs","toFixed","convertCurrentTime","Message","createdAt","text","date","isMe","isTyping","audio","readed","onRemoveMessage","setImageUrl","onShowImage","url","classNames","isAudio","isReaded","content","type","trigger","shape","icon","key","replace","filename","renderAttachment","Time","Date","defaultProps","DialogItem","create_at","partner","lastMessage","author","currentDialogId","userId","to","isOnline","isToday","format","formatInWordsToNow","addSuffix","locale","ruLocale","IconReaded","readedSvg","noReadedSvg","Dialogs","items","onSearch","inputValue","isLoading","Search","Input","value","onChange","target","placeholder","tip","orderBy","description","Status","online","ChatInput","setValue","toggleEmoji","emojiVisible","addEmoji","selectFile","removeAttachment","isDisabled","inputRef","handleSendMessage","onSendMessage","isRecording","handleStartRecording","onStopRecording","onRecord","onSelect","TextArea","test","autoSize","minRows","maxRows","allowClear","onKeyUp","disabled","onFiles","containerProps","uploadProps","accept","multiple","Messages","boxRef","removeMessageById","showImage","setShowImage","imageUrl","dialogsItems","currentDialog","find","bind","visible","footer","onCancel","touched","errors","openNotification","message","notification","FormField","handleChange","handleBlur","Item","help","validateStatus","validateField","hasFeedback","prefix","onBlur","socket","io","axios","defaults","baseURL","headers","common","localStorage","token","get","a","async","post","data","dialog_id","delete","postData","query","formData","FormData","append","actions","setCurrentDialog","SET_CURRENT_DIALOG","payload","setItems","SET_ITEMS","fetchDialogs","dispatch","setIsLoading","dialogsApi","updateDialog","dialog","UPDATE_DIALOG","updateDialogs","operation","getState","state","oldDialogs","dialogs","some","createDialog","result","response","status","bool","SET_IS_LOADING","setMessages","fetchMessages","messagesApi","then","addMessage","ADD_MESSAGE","dialogsActions","updateUnreadMessages","messages","currentMessages","filter","REMOVE_MESSAGE","sendMessage","setAuth","SET_IS_AUTH","setUserData","SET_USER_DATA","fetchUserData","userApi","signOut","messagesActions","fetchLoginData","signUserUp","initializeApp","isAuth","promise","userActions","Promise","all","INITIALIZED_SUCCESS","setAttachments","files","SET_ATTACHMENTS","REMOVE_ATTACHMENT","upload","filesApi","React","memo","setInputValue","Array","from","filtered","setFiltered","onUpdateDialogs","onDeleteMessage","onNewMessage","on","removeListener","toLowerCase","indexOf","connect","setIsTyping","typingTimeoutId","toggleIsTyping","dialogId","clearInterval","updateUnread","messagesRef","useCallback","node","scrollTo","attachmentsActions","setEmojiVisible","setIsRecording","setIsDisabled","mediaRecorder","setMediaRecorder","navigator","getUserMedia","mozGetUserMedia","msGetUserMedia","webkitGetUserMedia","onRecording","stream","recorder","MediaRecorder","start","onstart","onstop","ondataavailable","File","sendAudio","onError","err","audioId","stop","uid","onOutSideClick","el","contains","elHeight","offsetHeight","document","querySelector","height","removeEventListener","emoji","native","uploaded","i","random","name","emit","keyCode","currentDialogObj","withRouter","setVisible","users","setUsers","newMessageText","setNewMessageText","setPartner","undefined","selectInputValue","setSelectInputValue","showModal","handleCancel","handleOk","history","push","onInputSelect","val","error","onAddNewMessage","onInputChange","Option","Select","Sidebar","modalText","options","title","confirmLoading","loading","label","showSearch","optionFilterProp","filterOption","getBase64","reject","reader","FileReader","readAsDataURL","onload","onerror","UploadFiles","previewVisible","setPreviewVisible","previewImage","setPreviewImage","fileList","setFileList","action","listType","onPreview","preview","originFileObj","onRemove","subTitle","ErrorBoundry","errorIndicator","this","Component","LoginForm","handleSubmit","isSubmitting","onSubmit","values","rules","email","password","password_2","forEach","LoginFormContainer","withFormik","mapPropsToValues","validate","validateFunc","setSubmitting","displayName","RegisterForm","CheckEmailInfo","location","search","verified","setVerified","setError","info","extra","renderTextInfo","catch","Auth","exact","path","component","pathname","pop","fontSize","marginRight","cursor","confirm","app","isInitialized","appActions","render","position","left","top","transform","ReactDOM","getElementById","initialState","newItems","combineReducers","reduce","initial","default"],"mappings":"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","file":"static/js/main.391c0273.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/play.65f03140.svg\";","module.exports = __webpack_public_path__ + \"static/media/wave.2b8196a5.svg\";","module.exports = __webpack_public_path__ + \"static/media/pause.a61933e8.svg\";","module.exports = __webpack_public_path__ + \"static/media/readed.c1f419d6.svg\";","module.exports = __webpack_public_path__ + \"static/media/noreaded.3c841bf6.svg\";","var map = {\n\t\"./\": 95,\n\t\"./app\": 97,\n\t\"./app.js\": 97,\n\t\"./attachments\": 98,\n\t\"./attachments.js\": 98,\n\t\"./dialogs\": 71,\n\t\"./dialogs.js\": 71,\n\t\"./index\": 95,\n\t\"./index.js\": 95,\n\t\"./messages\": 72,\n\t\"./messages.js\": 72,\n\t\"./user\": 99,\n\t\"./user.js\": 99\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 291;","import {createStore} from \"redux\";\r\nimport {applyMiddleware} from \"redux\";\r\nimport thunk from \"redux-thunk\";\r\nimport {compose} from 'redux';\r\n\r\nimport rootReducer from \"./reduces\";\r\n\r\nconst middleware = [thunk];\r\n\r\nconst composeEnhancers =\r\n  typeof window === 'object' &&\r\n  window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ ?   \r\n    window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({\r\n    }) : compose;\r\n\r\n    const enhancer = composeEnhancers(\r\n      applyMiddleware(...middleware),\r\n      // other store enhancers if any\r\n    );\r\n\r\n\r\nlet store = createStore(rootReducer, enhancer);\r\n\r\nexport default store;","import React from 'react';\r\nimport propTypes from 'prop-types';\r\nimport {Button as BaseButton} from 'antd';\r\nimport classnames from 'classnames';\r\n\r\nimport './Button.scss';\r\n\r\nconst Button = props => {\r\n  return (\r\n    <BaseButton {...props} className={classnames(\"button\", props.className, {'button--large': props.size === 'large'})} />\r\n  );\r\n};\r\n\r\nButton.propTypes = {\r\n  className: propTypes.string\r\n};\r\n\r\nexport default Button;","import React from 'react';\r\nimport classnames from 'classnames';\r\n\r\n\r\nimport './Block.scss';\r\n\r\nexport default function Block({children, className}) {\r\nreturn <div className = {classnames('block',className)}>{children}</div>\r\n}\r\n","export default attachments => {\n  if (!attachments) {\n    return null;\n  }\n  const file = attachments[0];\n  return attachments.length && file.ext === \"webm\";\n};\n","import tinycolor from \"tinycolor2\";\r\n\r\nconst getCorrectIndex = index => {\r\n  return index.charCodeAt(0) > 255\r\n    ? 255\r\n    : index.charCodeAt(0) < 0\r\n    ? 0\r\n    : index.charCodeAt(0);\r\n};\r\n\r\nconst createAvatarFromHash = hash => {\r\n  const [r, g, b] = hash\r\n    .substr(11, 14)\r\n    .split(\"\")\r\n    .map(item => {\r\n      return getCorrectIndex(item);\r\n    });\r\n  return {\r\n    color: tinycolor({ r, g, b })\r\n      .lighten(10)\r\n      .saturate(15)\r\n      .toHexString(),\r\n    colorLighten: tinycolor({ r, g, b })\r\n      .lighten(30)\r\n      .saturate(30)\r\n      .toHexString()\r\n  };\r\n};\r\n\r\nexport default createAvatarFromHash;\r\n","import React from \"react\";\r\nimport createAvatarFromHash from \"../../utils/helpers/createAvatarFromHash\";\r\n\r\nimport \"./Avatar.scss\";\r\n\r\nexport default function Avatar({ user }) {\r\n  if (user) {\r\n    if (user.avatar) {\r\n      return (\r\n        <img\r\n          src={user.avatar}\r\n          className=\"avatar\"\r\n          alt={`Avatar ${user.fullname}`}\r\n        />\r\n      );\r\n    } else {\r\n      const { color, colorLighten } = createAvatarFromHash(user._id);\r\n      const firstChar = user.fullname[0].toUpperCase();\r\n      return (\r\n        <div\r\n          style={{\r\n            background: `linear-gradient(135deg, ${color} 0%, ${colorLighten} 96.52%)`\r\n          }}\r\n          className=\"avatar avatar--symbol\"\r\n        >\r\n          {firstChar}\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n","import React, { useState, useRef, useEffect } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport classNames from \"classnames\";\r\n\r\nimport convertCurrentTime from \"../../utils/helpers/convertCurentTime\";\r\nimport isAudio from \"../../utils/helpers/isAudio\";\r\n\r\nimport { Popover, Button } from \"antd\";\r\n\r\nimport { Time, IconReaded } from \"./../../components\";\r\nimport playSvg from \"../../assets/img/play.svg\";\r\nimport waveSvg from \"../../assets/img/wave.svg\";\r\nimport pauseSvg from \"../../assets/img/pause.svg\";\r\nimport Avatar from \"../Avatar\";\r\n\r\nimport \"./Message.scss\";\r\nconst Render = require(\"react-emoji-render\");\r\nconst Emoji = Render.Emojione;\r\n\r\nconst MessageAudio = ({ audioSrc }) => {\r\n  const [isPlaying, setIsPlaying] = useState(false);\r\n  const [currentTime, setCurrentTime] = useState(0);\r\n  const [progress, setProgress] = useState(0);\r\n  const audioEl = useRef(null);\r\n\r\n  const toggleAudio = () => {\r\n    if (!isPlaying) {\r\n      audioEl.current.play();\r\n    } else {\r\n      audioEl.current.pause();\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    setTimeout(() => console.log(audioEl.current.duration), 2000);\r\n\r\n    audioEl.current.addEventListener(\"playing\", () => setIsPlaying(true));\r\n    audioEl.current.addEventListener(\"ended\", () => {\r\n      setIsPlaying(false);\r\n      setProgress(0);\r\n      setCurrentTime(0);\r\n    });\r\n    audioEl.current.addEventListener(\"pause\", () => setIsPlaying(false));\r\n    audioEl.current.addEventListener(\"timeupdate\", () => {\r\n      const duration = (audioEl.current && audioEl.current.duration) || 0;\r\n\r\n      setCurrentTime(audioEl.current.currentTime);\r\n      setProgress((audioEl.current.currentTime / duration) * 100);\r\n    });\r\n  }, []);\r\n  return (\r\n    <div className=\"message__audio\">\r\n      <audio src={audioSrc} ref={audioEl} preload=\"auto\"></audio>\r\n      <div\r\n        style={{ width: progress + \"%\" }}\r\n        className=\"message__audio-progress\"\r\n      ></div>\r\n      <div className=\"message__audio-info\">\r\n        <div className=\"message__audio-btn\">\r\n          <button onClick={toggleAudio}>\r\n            {isPlaying ? (\r\n              <img src={pauseSvg} alt=\"Pause swg\" />\r\n            ) : (\r\n              <img src={playSvg} alt=\"Play swg\" />\r\n            )}\r\n          </button>\r\n        </div>\r\n        <div className=\"message__audio-wave\">\r\n          <img src={waveSvg} alt=\"Wave svg\" />\r\n        </div>\r\n        <div className=\"message__audio-duration\">\r\n          {convertCurrentTime(currentTime)}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\nconst Message = ({\r\n  createdAt,\r\n  text,\r\n  user,\r\n  date,\r\n  isMe,\r\n  attachments,\r\n  isTyping,\r\n  audio,\r\n  readed,\r\n  onRemoveMessage,\r\n  setImageUrl\r\n}) => {\r\n  const renderAttachment = item => {\r\n    if (item.ext !== \"webm\") {\r\n      return (\r\n        <div key={item._id} className=\"message__attachments-item\">\r\n          <img\r\n            src={item.url.replace(/http/, \"https\")}\r\n            alt={item.filename}\r\n            onClick={() => {\r\n              onShowImage(item.url);\r\n            }}\r\n          />\r\n        </div>\r\n      );\r\n    } else {\r\n      return <MessageAudio key={item._id} audioSrc={item.url} />;\r\n    }\r\n  };\r\n\r\n  let onShowImage = url => {\r\n    setImageUrl(url);\r\n  };\r\n  return (\r\n    <div\r\n      className={classNames(\"message\", {\r\n        \"message--isme\": isMe,\r\n        \"message--is-typing\": isTyping,\r\n        \"message--image\": attachments && attachments.length === 1 && !text,\r\n        \"message--is-audio\": isAudio(attachments)\r\n      })}\r\n    >\r\n      <div className=\"message__content\">\r\n        <IconReaded isMe={isMe} isReaded={readed} />\r\n        <div className=\"message__icon-actions\">\r\n          <Popover\r\n            content={\r\n              <div>\r\n                <Button onClick={onRemoveMessage} type=\"danger\">\r\n                  Удалить сообщение\r\n                </Button>\r\n              </div>\r\n            }\r\n            trigger=\"click\"\r\n          >\r\n            <Button type=\"link\" shape=\"circle\" icon=\"ellipsis\" />\r\n          </Popover>\r\n        </div>\r\n        <div className=\"message__avatar\">\r\n          <Avatar user={user} />\r\n        </div>\r\n        <div className=\"message__info\">\r\n          {\" \"}\r\n          {(isTyping || text) && (\r\n            <div className=\"message__bubble\">\r\n              {text && <p className=\"message__text\">{<Emoji text={text} />}</p>}\r\n\r\n              {isTyping && (\r\n                <div className=\"message__typing\">\r\n                  <span></span>\r\n                  <span></span>\r\n                  <span></span>\r\n                </div>\r\n              )}\r\n              {audio && <MessageAudio audioSrc={audio} />}\r\n            </div>\r\n          )}\r\n          {attachments && (\r\n            <div className=\"message__attachments\">\r\n              {attachments.map(item => renderAttachment(item))}\r\n            </div>\r\n          )}\r\n          {date && (\r\n            <span className=\"message__date\">\r\n              <Time date={new Date(createdAt)} />\r\n            </span>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nMessage.defaultProps = {\r\n  user: {}\r\n};\r\n\r\nMessage.propTypes = {\r\n  avatar: PropTypes.string,\r\n  text: PropTypes.string,\r\n  user: PropTypes.object,\r\n  data: PropTypes.instanceOf(Date),\r\n  attachments: PropTypes.array,\r\n  isTyping: PropTypes.bool,\r\n  isReaded: PropTypes.bool,\r\n  isMe: PropTypes.bool\r\n};\r\n\r\nexport default Message;\r\n","export default number => {\r\n  const mins = Math.floor(number / 60);\r\n  const secs = (number % 60).toFixed();\r\n  return `${mins < 10 ? \"0\" : \"\"}${mins}:${secs < 10 ? \"0\" : \"\"}${secs}`;\r\n};\r\n","import React from \"react\";\r\nimport classNames from \"classnames\";\r\nimport format from \"date-fns/format\";\r\nimport { Icon } from \"antd\";\r\nimport { IconReaded } from \"..\";\r\nimport isToday from \"date-fns/isToday\";\r\nimport Avatar from \"../Avatar\";\r\nimport { Link } from \"react-router-dom\";\r\nconst Render = require(\"react-emoji-render\");\r\nconst Emoji = Render.Emojione;\r\nconst getMessageTime = create_at => {\r\n  if (isToday(new Date(create_at))) {\r\n    return format(new Date(create_at), \"HH:mm\");\r\n  } else {\r\n    return format(new Date(create_at), \"dd.MM.yyyy\");\r\n  }\r\n};\r\n\r\nexport default function DialogItem({\r\n  _id,\r\n  isMe,\r\n  partner,\r\n  lastMessage,\r\n  author,\r\n  currentDialogId,\r\n  userId\r\n}) {\r\n  let user = isMe ? partner : author;\r\n\r\n  return (\r\n    <Link to={`/dialog/${_id}`}>\r\n      <div\r\n        className={classNames(\"dialogs__item\", {\r\n          \"dialogs__item--online\": user.isOnline,\r\n          \"dialogs__item--active\": currentDialogId === _id\r\n        })}\r\n      >\r\n        <div className=\"dialogs__item-avatar\">\r\n          <Avatar user={user} />\r\n        </div>\r\n        <div className=\"dialogs__item-info\">\r\n          <div className=\"dialogs__item-info-top\">\r\n            <b>{user.fullname}</b>\r\n            {lastMessage && (\r\n              <span>{getMessageTime(new Date(lastMessage.createdAt))}</span>\r\n            )}\r\n          </div>\r\n          <div className=\"dialogs__item-info-bottom\">\r\n            {lastMessage && lastMessage.text && (\r\n              <p>{<Emoji text={lastMessage.text} />}</p>\r\n            )}\r\n            {lastMessage && (\r\n              <IconReaded\r\n                isMe={userId === lastMessage.user._id}\r\n                isReaded={lastMessage.readed}\r\n              />\r\n            )}\r\n            {lastMessage.user._id !== userId && lastMessage.readed === false && (\r\n              <div className=\"dialogs__item-info-bottom-count\">\r\n                <Icon type=\"mail\" />\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </Link>\r\n  );\r\n}\r\n","import React, {Fragment} from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport formatInWordsToNow from \"date-fns/formatDistanceToNow\";\r\nimport ruLocale from \"date-fns/locale/ru\";\r\n\r\n\r\nexport default function Time({ date }) {\r\n  return <Fragment>{formatInWordsToNow(date, { addSuffix: true, locale: ruLocale })}</Fragment> \r\n}\r\n\r\nTime.propTypes = {\r\n  data: PropTypes.instanceOf(Date)\r\n};\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport readedSvg from \"../../assets/img/readed.svg\";\r\nimport noReadedSvg from \"../../assets/img/noreaded.svg\";\r\n\r\nimport \"./IconReaded.scss\";\r\n\r\nexport default function IconReaded({ isMe, isReaded }) {\r\n  return (\r\n    <div>\r\n      {isMe &&\r\n        (isReaded ? (\r\n          <img\r\n            className=\"message__icon-readed\"\r\n            src={readedSvg}\r\n            alt=\"Readed icon\"\r\n          />\r\n        ) : (\r\n          <img\r\n            className=\"message__icon-readed message__icon-readed--no\"\r\n            src={noReadedSvg}\r\n            alt=\"No readed icon\"\r\n          />\r\n        ))}\r\n    </div>\r\n  );\r\n}\r\n\r\nIconReaded.propTypes = {\r\n  isReaded: PropTypes.bool,\r\n  isMe: PropTypes.bool\r\n};\r\n","import React from \"react\";\r\nimport orderBy from \"lodash/orderBy\";\r\nimport { Input } from \"antd\";\r\nimport { Empty, Spin } from \"antd\";\r\n\r\nimport { DialogItem } from \"..\";\r\n\r\nimport \"./Dialogs.scss\";\r\n\r\nexport default function Dialogs({\r\n  items,\r\n  userId,\r\n  onSearch,\r\n  inputValue,\r\n  isLoading,\r\n  currentDialogId\r\n}) {\r\n  const Search = Input.Search;\r\n\r\n  return (\r\n    <div className=\"dialogs\">\r\n      <div className=\"dialogs__search\">\r\n        <Search\r\n          value={inputValue}\r\n          onChange={e => {\r\n            onSearch(e.target.value);\r\n          }}\r\n          placeholder=\"Поиск среди контактов\"\r\n        />\r\n      </div>\r\n\r\n      <div>\r\n        {isLoading ? (\r\n          <Spin tip=\"Загрузка диалогов\" />\r\n        ) : items ? (\r\n          items.length > 0 ? (\r\n            orderBy(items, [\"created_at\"], [\"desc\"]).map(item => {\r\n              return (\r\n                <DialogItem\r\n                  key={item._id}\r\n                  isMe={item.author._id === userId}\r\n                  userId={userId}\r\n                  currentDialogId={currentDialogId}\r\n                  {...item}\r\n                />\r\n              );\r\n            })\r\n          ) : (\r\n            <Empty description=\"Ничего не найдено\" />\r\n          )\r\n        ) : null}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport classNames from \"classnames\";\r\n\r\nimport \"./Status.scss\";\r\n\r\nexport default function Status({ online, fullname }) {\r\n  return (\r\n    <div className=\"chat__dialog-header-center\">\r\n      <b className=\"chat__dialog-header-username\">{fullname}</b>\r\n      <div className=\"chat__dialog-header-status\"></div>\r\n      <div className={classNames(\"status\", { \"status--online\": online })}>\r\n        {online ? \"онлайн\" : \"офлайн\"}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React, { Fragment } from \"react\";\r\nimport { Picker } from \"emoji-mart\";\r\nimport \"emoji-mart/css/emoji-mart.css\";\r\nimport { UploadField } from \"@navjobs/upload\";\r\nimport { UploadFiles } from \"../\";\r\n\r\nimport { Button, Input } from \"antd\";\r\n\r\nimport \"./ChatInput.scss\";\r\n\r\nconst ChatInput = props => {\r\n  const {\r\n    value,\r\n    setValue,\r\n    toggleEmoji,\r\n    emojiVisible,\r\n    addEmoji,\r\n    selectFile,\r\n    attachments,\r\n    removeAttachment,\r\n    isDisabled,\r\n    inputRef,\r\n    handleSendMessage,\r\n    onSendMessage,\r\n    handleStartRecording,\r\n    isRecording,\r\n    onStopRecording,\r\n    onRecord\r\n  } = props;\r\n\r\n  return (\r\n    <Fragment>\r\n      <div ref={inputRef} className=\"chat-input\">\r\n        <div>\r\n          <div className=\"chat-input__smile-btn\">\r\n            <div className=\"chat-input__emoji-picker\">\r\n              {emojiVisible && <Picker onSelect={addEmoji} />}\r\n            </div>\r\n\r\n            <Button\r\n              onClick={toggleEmoji}\r\n              type=\"link\"\r\n              shape=\"circle\"\r\n              icon=\"smile\"\r\n            />\r\n          </div>\r\n          {isRecording ? (\r\n            <div className=\"chat-input__record-status\">\r\n              <i className=\"chat-input__record-status-bubble\"></i>\r\n              Recording...\r\n              <Button\r\n                className=\"stop-recording\"\r\n                type=\"link\"\r\n                shape=\"circle\"\r\n                icon=\"close\"\r\n                onClick={onStopRecording}\r\n              />\r\n            </div>\r\n          ) : (\r\n            <Input.TextArea\r\n              onChange={e => {\r\n                let re = /^\\s/;\r\n                let check = re.test(e.target.value);\r\n                if (!check) {\r\n                  setValue(e.target.value);\r\n                }\r\n              }}\r\n              placeholder=\"Введите текст сообщения\"\r\n              autoSize={{ minRows: 1, maxRows: 8 }}\r\n              allowClear={true}\r\n              value={value}\r\n              onKeyUp={handleSendMessage}\r\n              disabled={isDisabled}\r\n            />\r\n          )}\r\n\r\n          <div className=\"chat-input__actions\">\r\n            {value || attachments.length || isRecording ? (\r\n              <Button\r\n                disabled={isDisabled}\r\n                onClick={onSendMessage}\r\n                size=\"large\"\r\n                type=\"link\"\r\n                icon=\"right-circle\"\r\n              />\r\n            ) : (\r\n              <div className=\"chat-input__record-btn\">\r\n                <Button\r\n                  onClick={onRecord}\r\n                  type=\"link\"\r\n                  shape=\"circle\"\r\n                  icon=\"audio\"\r\n                />\r\n              </div>\r\n            )}\r\n\r\n            <UploadField\r\n              onFiles={selectFile}\r\n              containerProps={{\r\n                className: \"chat-input__actions-upload-btn\"\r\n              }}\r\n              uploadProps={{\r\n                accept: \".jpg,.jpeg,.png,.gif,.bmp\",\r\n                multiple: \"multiple\"\r\n              }}\r\n            >\r\n              <Button type=\"link\" shape=\"circle\" icon=\"camera\" />\r\n            </UploadField>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div>\r\n        <UploadFiles\r\n          attachments={attachments}\r\n          removeAttachment={removeAttachment}\r\n        />\r\n      </div>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nChatInput.propTypes = {};\r\n\r\nexport default ChatInput;\r\n","import React from \"react\";\r\nimport propTypes from \"prop-types\";\r\nimport classNames from \"classnames\";\r\nimport find from \"lodash/find\";\r\n\r\nimport { Empty, Spin, Modal } from \"antd\";\r\n\r\nimport { Message } from \"../\";\r\n\r\nimport \"./Messages.scss\";\r\n\r\nconst Messages = ({\r\n  items,\r\n  isLoading,\r\n  boxRef,\r\n  currentDialogId,\r\n  userId,\r\n  removeMessageById,\r\n  attachments,\r\n  setImageUrl,\r\n  showImage,\r\n  setShowImage,\r\n  imageUrl,\r\n  dialogsItems,\r\n  isTyping\r\n}) => {\r\n  let currentDialog =\r\n    dialogsItems && find(dialogsItems, { _id: currentDialogId });\r\n  let partner;\r\n  if (currentDialog) {\r\n    partner =\r\n      currentDialog.partner.id === userId\r\n        ? currentDialog.author\r\n        : currentDialog.partner;\r\n  }\r\n\r\n  let handleCancel = () => {\r\n    setShowImage(false);\r\n    setImageUrl(null);\r\n  };\r\n  return (\r\n    <div\r\n      className={classNames(\"chat__dialog-messages\", {\r\n        \"chat__dialog-messages-attachments\": attachments.length\r\n      })}\r\n    >\r\n      <div\r\n        ref={boxRef}\r\n        className={classNames(\"messages\", { \"messages--loading\": isLoading })}\r\n      >\r\n        {isLoading ? (\r\n          <Spin size=\"large\" tip=\"Загрузка сообщений...\" />\r\n        ) : items && !isLoading && currentDialogId ? (\r\n          items.length > 0 ? (\r\n            items.map(item => {\r\n              return (\r\n                <Message\r\n                  key={item._id}\r\n                  alt=\"User avatar\"\r\n                  text={item.text}\r\n                  date={new Date()}\r\n                  isMe={item.user._id === userId}\r\n                  {...item}\r\n                  isTyping={false}\r\n                  onRemoveMessage={removeMessageById.bind(this, item._id)}\r\n                  setImageUrl={setImageUrl}\r\n                />\r\n              );\r\n            })\r\n          ) : (\r\n            <Empty description=\"Диалог пуст\" />\r\n          )\r\n        ) : (\r\n          <Empty description=\"Виберите диалог\" />\r\n        )}{\" \"}\r\n        {isTyping && !isLoading && <Message isTyping={true} user={partner} />}\r\n      </div>\r\n\r\n      {imageUrl && (\r\n        <Modal visible={showImage} footer={null} onCancel={handleCancel}>\r\n          <img alt=\"previewImg\" style={{ width: \"100%\" }} src={imageUrl} />\r\n        </Modal>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nMessages.propTypes = {\r\n  className: propTypes.string\r\n};\r\n\r\nexport default Messages;\r\n","export default (key, touched, errors) => {\r\n  if (touched[key]) {\r\n    if (errors[key]) {\r\n      return \"error\";\r\n    } else {\r\n      return \"success\";\r\n    }\r\n  } else {\r\n    return \"\";\r\n  }\r\n};\r\n","import { notification } from \"antd\";\r\n\r\nconst openNotification = ({ type, message, description, duration }) => {\r\n  notification[type]({\r\n    message,\r\n    description,\r\n    duration\r\n  });\r\n};\r\nexport default openNotification;\r\n","import React from \"react\";\r\nimport { Form, Icon, Input } from \"antd\";\r\n\r\nimport { validateField } from \"../../utils/helpers\";\r\n\r\nexport default function FormField({\r\n  errors,\r\n  type,\r\n  icon,\r\n  placeholder,\r\n  handleChange,\r\n  handleBlur,\r\n  id,\r\n  touched\r\n}) {\r\n  return (\r\n    <Form.Item\r\n      help={touched[id] && errors[id]}\r\n      validateStatus={validateField(id, touched, errors)}\r\n      hasFeedback\r\n    >\r\n      {\" \"}\r\n      <Input\r\n        prefix={<Icon type={icon} style={{ color: \"rgba(0,0,0,.25)\" }} />}\r\n        type={type}\r\n        placeholder={placeholder}\r\n        id={id}\r\n        onChange={handleChange}\r\n        onBlur={handleBlur}\r\n      />\r\n    </Form.Item>\r\n  );\r\n}\r\n","import io from \"socket.io-client\";\r\n\r\nconst socket = io(\"https://my-messager-api.herokuapp.com/\");\r\n\r\nexport default socket;\r\n//https://my-messager-api.herokuapp.com/\r\n","import axios from \"axios\";\r\n\r\naxios.defaults.baseURL = \"https://my-messager-api.herokuapp.com/\";\r\naxios.defaults.headers.common[\"token\"] = window.localStorage.token;\r\nwindow.axios = axios;\r\n\r\nexport default axios;\r\n//https://my-messager-api.herokuapp.com/\r\n\r\n//http://localhost:3003\r\n","import { axios } from \"../../core\";\r\n\r\nexport default {\r\n  getAll: () => {\r\n    return axios.get(\"dialogs\");\r\n  },\r\n  createDialog: async ({ partner, text }) => {\r\n    let data = await axios.post(\"dialogs\", { partner, text });\r\n    return data.data;\r\n  }\r\n};\r\n","import { axios } from \"../../core\";\r\n\r\nexport default {\r\n  getAllByDialogId: id => {\r\n    return axios.get(\"messages?dialog=\" + id);\r\n  },\r\n  sendMessage: ({ text, currentDialogId, attachments }) => {\r\n    return axios.post(\"messages\", {\r\n      text,\r\n      attachments,\r\n      dialog_id: currentDialogId\r\n    });\r\n  },\r\n  removeMessageById: async id => {\r\n    let data = await axios.delete(\"messages?id=\" + id);\r\n    return data.data;\r\n  }\r\n};\r\n","import { axios } from \"../../core\";\r\n\r\nexport default {\r\n  signUserIn: postData => {\r\n    return axios.post(\"user/login\", postData);\r\n  },\r\n\r\n  getUserInfo: () => {\r\n    return axios.get(\"user/me\");\r\n  },\r\n  signUserUp: postData => {\r\n    return axios.post(\"user/registration\", postData);\r\n  },\r\n  verifyHash: async hash => {\r\n    let data = await axios.get(`user/verify?hash=${hash}`);\r\n    return data;\r\n  },\r\n  findUsers: async query => {\r\n    let data = await axios.get(`user/find?query=${query}`);\r\n    return data.data;\r\n  }\r\n};\r\n","import { axios } from \"../../core\";\r\n\r\nexport default {\r\n  file: async file => {\r\n    const formData = new FormData();\r\n    formData.append(\"file\", file);\r\n    let data = await axios.post(\"files\", formData, {\r\n      headers: {\r\n        \"content-type\": \"multipart/form-data\"\r\n      }\r\n    });\r\n    return data.data;\r\n  }\r\n};\r\n// fileUpload(file){\r\n//   const url = 'http://example.com/file-upload';\r\n//   const formData = new FormData();\r\n\r\n//   formData.append('file',file)\r\n//   const config = {\r\n","import { dialogsApi } from \"../../utils/api\";\r\nimport { openNotification } from \"../../utils/helpers\";\r\nimport {\r\n  SET_CURRENT_DIALOG,\r\n  SET_ITEMS,\r\n  UPDATE_DIALOG,\r\n  SET_IS_LOADING\r\n} from \"../reduces/dialogs\";\r\n\r\nconst actions = {\r\n  setCurrentDialog: id => ({ type: SET_CURRENT_DIALOG, payload: id }),\r\n  setItems: items => ({ type: SET_ITEMS, payload: items }),\r\n  fetchDialogs: () => async dispatch => {\r\n    dispatch(actions.setIsLoading(true));\r\n    let data = await dialogsApi.getAll();\r\n    dispatch(actions.setItems(data.data));\r\n    dispatch(actions.setIsLoading(false));\r\n  },\r\n  updateDialog: dialog => {\r\n    return { type: UPDATE_DIALOG, payload: dialog };\r\n  },\r\n  updateDialogs: ({ operation = \"\", item }) => (dispatch, getState) => {\r\n    let state = getState();\r\n\r\n    if (operation === \"SERVER:CREATE_DIALOG\") {\r\n      let oldDialogs = state.dialogs.items;\r\n      let userId = state.user.data.user._id;\r\n      let author = item.author._id;\r\n      let partner = item.partner._id;\r\n      let check = userId === partner || userId === author;\r\n      if (check) {\r\n        dispatch(actions.setItems([...oldDialogs, item]));\r\n      }\r\n    } else if (\r\n      operation === \"SERVER:NEW_MESSAGE\" ||\r\n      operation === \"SERVER:DELETE_MESSAGE\"\r\n    ) {\r\n      let dialogs = state.dialogs.items;\r\n\r\n      let check = dialogs.some(dialog => {\r\n        return dialog._id === item.dialog._id;\r\n      });\r\n      if (check) {\r\n        dispatch(actions.updateDialog(item.dialog));\r\n      }\r\n    }\r\n  },\r\n  createDialog: ({ partner, text }) => async dispatch => {\r\n    try {\r\n      let result = await dialogsApi.createDialog({\r\n        partner,\r\n        text\r\n      });\r\n      return result;\r\n    } catch (err) {\r\n      if (err.response.status === 403) {\r\n        openNotification({\r\n          type: \"error\",\r\n          message: \"Такой диалог уже существует\"\r\n        });\r\n      } else {\r\n        openNotification({\r\n          type: \"error\",\r\n          message: \"Ошибка\"\r\n        });\r\n      }\r\n    }\r\n  },\r\n  setIsLoading: bool => {\r\n    return { type: SET_IS_LOADING, payload: bool };\r\n  }\r\n};\r\n\r\nexport default actions;\r\n","import { messagesApi } from \"../../utils/api\";\r\nimport { dialogsActions } from \"./index\";\r\nimport {\r\n  SET_ITEMS,\r\n  ADD_MESSAGE,\r\n  REMOVE_MESSAGE,\r\n  SET_IS_LOADING\r\n} from \"../reduces/messages\";\r\n\r\nconst actions = {\r\n  setMessages: items => ({ type: SET_ITEMS, payload: items }),\r\n  fetchMessages: id => dispatch => {\r\n    dispatch(actions.setIsLoading(true));\r\n    messagesApi.getAllByDialogId(id).then(({ data }) => {\r\n      dispatch(actions.setMessages(data));\r\n      dispatch(actions.setIsLoading(false));\r\n    });\r\n  },\r\n  addMessage: message => (dispatch, getState) => {\r\n    let { dialogs } = getState();\r\n    let userId = getState().user.data.user._id;\r\n\r\n    if (dialogs.currentDialogId === message.dialog._id) {\r\n      dispatch({ type: ADD_MESSAGE, payload: message });\r\n\r\n      if (userId !== message.user._id) {\r\n        messagesApi.getAllByDialogId(message.dialog._id);\r\n        dispatch(dialogsActions.updateDialog(message.dialog));\r\n      }\r\n    }\r\n  },\r\n\r\n  updateUnreadMessages: ({ messages, dialog }) => async (\r\n    dispatch,\r\n    getState\r\n  ) => {\r\n    let userId = getState().user.data.user._id;\r\n    let currentDialogId = await getState().dialogs.currentDialogId;\r\n\r\n    let author = dialog.author._id;\r\n    let partner = dialog.partner._id;\r\n    let hasDialog = userId === partner || userId === author;\r\n\r\n    if (hasDialog) {\r\n      if (dialog && dialog._id === currentDialogId) {\r\n        let currentMessages = getState().messages.items.filter(message => {\r\n          return (\r\n            message.dialog._id === currentDialogId &&\r\n            message.user._id === userId\r\n          );\r\n        });\r\n        let check = currentMessages.some(message => message.readed !== true);\r\n        if (check) {\r\n          await dispatch(actions.setMessages(messages));\r\n          await dispatch(dialogsActions.updateDialog(dialog));\r\n        }\r\n        dispatch(dialogsActions.updateDialog(dialog));\r\n      } else {\r\n        dispatch(dialogsActions.updateDialog(dialog));\r\n      }\r\n    }\r\n  },\r\n  removeMessageById: id => async dispatch => {\r\n    let data = await messagesApi.removeMessageById(id);\r\n    if (data.status === \"success\") {\r\n      dispatch({ type: REMOVE_MESSAGE, payload: id });\r\n    }\r\n  },\r\n  sendMessage: ({ text, currentDialogId, attachments }) => dispatch => {\r\n    messagesApi.sendMessage({ text, currentDialogId, attachments });\r\n  },\r\n  setIsLoading: bool => {\r\n    return { type: SET_IS_LOADING, payload: bool };\r\n  }\r\n};\r\n\r\nexport default actions;\r\n","import { userApi } from \"../../utils/api\";\r\nimport { openNotification } from \"../../utils/helpers\";\r\nimport { dialogsActions, messagesActions } from \"./index\";\r\nimport { SET_USER_DATA, SET_IS_AUTH } from \"../reduces/user\";\r\n\r\nconst actions = {\r\n  setAuth: payload => ({ type: SET_IS_AUTH, payload }),\r\n  setUserData: data => {\r\n    return {\r\n      type: SET_USER_DATA,\r\n      payload: data\r\n    };\r\n  },\r\n  fetchUserData: () => async dispatch => {\r\n    try {\r\n      const data = await userApi.getUserInfo();\r\n      if (data.data.status === \"success\") {\r\n        dispatch(actions.setUserData(data.data));\r\n        return data;\r\n      }\r\n    } catch (err) {\r\n      if (err.response.status === 403) {\r\n        delete window.localStorage.token;\r\n        window.axios.defaults.headers.common[\"token\"] = \"\";\r\n      } else {\r\n        throw new Error(err);\r\n      }\r\n    }\r\n  },\r\n  signOut: () => async dispatch => {\r\n    dispatch(actions.setAuth(false));\r\n    dispatch(actions.setUserData(null));\r\n    dispatch(dialogsActions.setItems([]));\r\n    dispatch(messagesActions.setMessages([]));\r\n    delete window.localStorage.token;\r\n    dispatch(dialogsActions.setCurrentDialog(null));\r\n  },\r\n\r\n  fetchLoginData: postData => async dispatch => {\r\n    try {\r\n      const data = await userApi.signUserIn(postData);\r\n      if (data.data.status === \"success\") {\r\n        const { token } = data.data;\r\n\r\n        window.localStorage[\"token\"] = token;\r\n        window.axios.defaults.headers.common[\"token\"] = token;\r\n\r\n        openNotification({\r\n          type: \"success\",\r\n          message: \"Авторизация пройшла успешно!\",\r\n          duration: 1\r\n        });\r\n        return data.data;\r\n      }\r\n    } catch (err) {\r\n      console.log(err);\r\n      if (err.response.status === 404) {\r\n        openNotification({\r\n          type: \"error\",\r\n          message: \"Ошибка при авторизации\",\r\n          description: \"Такой пользователь не зарегистрирован\"\r\n        });\r\n      } else if (err.response.status === 401) {\r\n        openNotification({\r\n          type: \"error\",\r\n          message: \"Ошибка при авторизации\",\r\n          description: \"Ваш аккаунт не подтвержден\"\r\n        });\r\n      } else {\r\n        delete window.localStorage.token;\r\n        window.axios.defaults.headers.common[\"token\"] = \"\";\r\n        openNotification({\r\n          type: \"error\",\r\n          message: \"Ошибка при авторизации\",\r\n          description: \"Неправильный логин или пароль\"\r\n        });\r\n      }\r\n    }\r\n  },\r\n  signUserUp: postData => async dispatch => {\r\n    try {\r\n      let data = await userApi.signUserUp(postData);\r\n      return data;\r\n    } catch (err) {\r\n      console.log(err);\r\n      if (err.response.status === 400) {\r\n        openNotification({\r\n          type: \"error\",\r\n          message: \"Ошибка при регистрации\",\r\n          description: \"Такой пользователь уже зарегистрирован\"\r\n        });\r\n      } else {\r\n        openNotification({\r\n          type: \"error\",\r\n          message: \"Server Error\",\r\n          description: \"Something went wrong\"\r\n        });\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nexport default actions;\r\n","import { userActions } from \"../actions\";\r\nimport { INITIALIZED_SUCCESS } from \"../reduces/app\";\r\n\r\nconst actions = {\r\n  initializeApp: () => (dispatch, getState) => {\r\n    let isAuth = getState().user.isAuth;\r\n    if (isAuth) {\r\n      let promise = dispatch(userActions.fetchUserData());\r\n      Promise.all([promise]).then(data => {\r\n        dispatch({ type: INITIALIZED_SUCCESS });\r\n      });\r\n    } else {\r\n      dispatch({ type: INITIALIZED_SUCCESS });\r\n    }\r\n  }\r\n};\r\n\r\nexport default actions;\r\n","import { filesApi } from \"../../utils/api\";\r\nimport { SET_ATTACHMENTS, REMOVE_ATTACHMENT } from \"../reduces/attachments\";\r\n\r\nconst actions = {\r\n  setAttachments: files => {\r\n    return {\r\n      type: SET_ATTACHMENTS,\r\n      payload: files\r\n    };\r\n  },\r\n  removeAttachment: file => {\r\n    return {\r\n      type: REMOVE_ATTACHMENT,\r\n      payload: file\r\n    };\r\n  },\r\n  upload: file => async dispatch => {\r\n    let data = await filesApi.file(file);\r\n    if (data && data.status === \"success\") {\r\n      return data.file;\r\n    }\r\n  }\r\n};\r\n\r\nexport default actions;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport socket from \"../core/socket\";\r\nimport { Dialogs as BaseDialogs } from \"../components\";\r\nimport { dialogsActions } from \"../redux/actions\";\r\n\r\nconst Dialogs = React.memo(\r\n  ({\r\n    items,\r\n    fetchDialogs,\r\n    isLoading,\r\n    userId,\r\n    currentDialogId,\r\n    updateDialogs\r\n  }) => {\r\n    let [inputValue, setInputValue] = useState(\"\");\r\n    let [filtered, setFiltered] = useState(Array.from(items));\r\n\r\n    let onUpdateDialogs = (item, operation = \"SERVER:CREATE_DIALOG\") => {\r\n      updateDialogs({ operation, item });\r\n    };\r\n    let onDeleteMessage = (item, operation = \"SERVER:DELETE_MESSAGE\") => {\r\n      updateDialogs({ operation, item });\r\n    };\r\n    let onNewMessage = (item, operation = \"SERVER:NEW_MESSAGE\") => {\r\n      updateDialogs({ operation, item });\r\n    };\r\n    let onSearch = value => {\r\n      setInputValue(value);\r\n      setFiltered(\r\n        items.filter(item => {\r\n          let user = userId === item.author._id ? item.partner : item.author;\r\n          return user.fullname.toLowerCase().indexOf(value) >= 0;\r\n        })\r\n      );\r\n    };\r\n\r\n    useEffect(() => {\r\n      setFiltered(items);\r\n    }, [items]);\r\n\r\n    useEffect(() => {\r\n      fetchDialogs();\r\n\r\n      socket.on(\"SERVER:CREATE_DIALOG\", onUpdateDialogs);\r\n      socket.on(\"SERVER:DELETE_MESSAGE\", onDeleteMessage);\r\n      socket.on(\"SERVER:NEW_MESSAGE\", onNewMessage);\r\n\r\n      return () => {\r\n        socket.removeListener(\"SERVER:CREATE_DIALOG\", onUpdateDialogs);\r\n\r\n        socket.removeListener(\"SERVER:NEW_MESSAGE\", onNewMessage);\r\n\r\n        socket.removeListener(\"SERVER:DELETE_MESSAGE\", onDeleteMessage);\r\n      };\r\n    }, []);\r\n\r\n    return (\r\n      <BaseDialogs\r\n        items={filtered}\r\n        onSearch={onSearch}\r\n        inputValue={inputValue}\r\n        isLoading={isLoading}\r\n        userId={userId}\r\n        currentDialogId={currentDialogId}\r\n      />\r\n    );\r\n  }\r\n);\r\n\r\nexport default connect(\r\n  ({ dialogs, user }) => ({\r\n    items: dialogs.items,\r\n    isLoading: dialogs.isLoading,\r\n    userId: user.data.user._id,\r\n    currentDialogId: dialogs.currentDialogId\r\n  }),\r\n  dialogsActions\r\n)(Dialogs);\r\n","import React, { useEffect, useCallback, useState } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport socket from \"../core/socket\";\r\nimport { Empty } from \"antd\";\r\n\r\nimport { Messages as BaseMessages } from \"../components\";\r\nimport { messagesActions } from \"../redux/actions\";\r\n\r\nconst Messages = ({\r\n  items,\r\n  fetchMessages,\r\n  currentDialogId,\r\n  isLoading,\r\n  addMessage,\r\n  removeMessageById,\r\n  updateUnreadMessages,\r\n  attachments,\r\n  userId,\r\n  dialogsItems\r\n}) => {\r\n  let [imageUrl, setImageUrl] = useState(null);\r\n  let [showImage, setShowImage] = useState(false);\r\n  const [isTyping, setIsTyping] = useState(false);\r\n  let typingTimeoutId = null;\r\n\r\n  const toggleIsTyping = data => {\r\n    if (data.dialogId === currentDialogId) {\r\n      setIsTyping(true);\r\n      clearInterval(typingTimeoutId);\r\n      typingTimeoutId = setTimeout(() => {\r\n        setIsTyping(false);\r\n      }, 3000);\r\n    }\r\n  };\r\n  const onNewMessage = message => {\r\n    addMessage(message);\r\n  };\r\n  const updateUnread = messages => {\r\n    updateUnreadMessages(messages);\r\n  };\r\n  const messagesRef = useCallback(\r\n    node => {\r\n      setTimeout(() => {\r\n        if (node !== null) {\r\n          node.scrollTo(0, 99999);\r\n        }\r\n      });\r\n    },\r\n    [items]\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (imageUrl) {\r\n      setShowImage(true);\r\n    }\r\n  }, [imageUrl]);\r\n\r\n  useEffect(() => {\r\n    if (currentDialogId !== null) {\r\n      fetchMessages(currentDialogId);\r\n    }\r\n    socket.on(\"SERVER:NEW_MESSAGE\", onNewMessage);\r\n    socket.on(\"SERVER:UPDATE_UNREADED_MESSAGES\", updateUnread);\r\n    socket.on(\"DIALOGS:TYPING\", toggleIsTyping);\r\n\r\n    return () => {\r\n      socket.removeListener(\"SERVER:NEW_MESSAGE\", onNewMessage);\r\n      socket.removeListener(\"SERVER:UPDATE_UNREADED_MESSAGES\", updateUnread);\r\n      socket.removeListener(\"DIALOGS:TYPING\", toggleIsTyping);\r\n    };\r\n  }, [currentDialogId]);\r\n\r\n  if (!currentDialogId) {\r\n    return <Empty description=\"Виберите диалог\" />;\r\n  }\r\n\r\n  return (\r\n    <BaseMessages\r\n      boxRef={messagesRef}\r\n      items={items}\r\n      isLoading={isLoading}\r\n      currentDialogId={currentDialogId}\r\n      removeMessageById={removeMessageById}\r\n      attachments={attachments}\r\n      setImageUrl={setImageUrl}\r\n      showImage={showImage}\r\n      setShowImage={setShowImage}\r\n      imageUrl={imageUrl}\r\n      userId={userId}\r\n      dialogsItems={dialogsItems}\r\n      isTyping={isTyping}\r\n    />\r\n  );\r\n};\r\n\r\nexport default connect(\r\n  ({ dialogs, messages, attachments, user }) => ({\r\n    userId: user.data.user._id,\r\n\r\n    items: messages.items,\r\n    dialogsItems: dialogs.items,\r\n    currentDialogId: dialogs.currentDialogId,\r\n    isLoading: messages.isLoading,\r\n    attachments: attachments.items\r\n  }),\r\n  messagesActions\r\n)(Messages);\r\n","import React, { useState, useEffect, useCallback } from \"react\";\r\nimport { ChatInput as ChatInputBase } from \"../components\";\r\nimport { connect } from \"react-redux\";\r\nimport messagesActions from \"../redux/actions/messages\";\r\nimport { attachmentsActions } from \"../redux/actions\";\r\nimport socket from \"../core/socket\";\r\nimport { filesApi } from \"../utils/api\";\r\n\r\nconst ChatInput = ({\r\n  currentDialogId,\r\n\r\n  sendMessage,\r\n  upload,\r\n  setAttachments,\r\n  removeAttachment,\r\n  attachments\r\n}) => {\r\n  const [value, setValue] = useState(\"\");\r\n  const [emojiVisible, setEmojiVisible] = useState(false);\r\n  const [isRecording, setIsRecording] = useState(false);\r\n  let [isDisabled, setIsDisabled] = useState(false);\r\n  const [mediaRecorder, setMediaRecorder] = useState(null);\r\n\r\n  window.navigator.getUserMedia =\r\n    window.navigator.getUserMedia ||\r\n    window.navigator.mozGetUserMedia ||\r\n    window.navigator.msGetUserMedia ||\r\n    window.navigator.webkitGetUserMedia;\r\n\r\n  const onRecord = () => {\r\n    if (navigator.getUserMedia) {\r\n      navigator.getUserMedia({ audio: true }, onRecording, onError);\r\n    }\r\n  };\r\n\r\n  const onRecording = stream => {\r\n    const recorder = new MediaRecorder(stream);\r\n    setMediaRecorder(recorder);\r\n\r\n    recorder.start();\r\n\r\n    recorder.onstart = () => {\r\n      setIsRecording(true);\r\n    };\r\n\r\n    recorder.onstop = () => {\r\n      setIsRecording(false);\r\n    };\r\n\r\n    recorder.ondataavailable = e => {\r\n      const file = new File([e.data], \"audio.webm\");\r\n      console.log(e.data);\r\n      //setLoading(true);\r\n      filesApi.file(file).then(data => {\r\n        sendAudio(data.file._id);\r\n      });\r\n    };\r\n  };\r\n\r\n  const onError = err => {\r\n    console.log(\"The following error occured: \" + err);\r\n  };\r\n\r\n  const sendAudio = audioId => {\r\n    console.log(currentDialogId);\r\n    return sendMessage({\r\n      text: null,\r\n      currentDialogId,\r\n      attachments: [audioId]\r\n    });\r\n  };\r\n  const onSendMessage = () => {\r\n    if (isRecording) {\r\n      mediaRecorder.stop();\r\n    } else if (value || attachments.length) {\r\n      sendMessage({\r\n        text: value,\r\n        currentDialogId,\r\n        attachments: attachments.map(file => file.uid)\r\n      });\r\n      setValue(\"\");\r\n      setAttachments([]);\r\n    }\r\n  };\r\n  const handleSendMessage = e => {\r\n    socket.emit(\"DIALOGS:TYPING\", { dialogId: currentDialogId });\r\n    if (value.length || attachments.length) {\r\n      if (e.keyCode === 13) {\r\n        onSendMessage(e);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleStartRecording = () => {\r\n    setIsRecording(true);\r\n  };\r\n  const onStopRecording = () => {\r\n    setIsRecording(false);\r\n  };\r\n  //----------------------EMOJI\r\n\r\n  const onOutSideClick = (e, el) => {\r\n    if (el && !el.contains(e.target)) {\r\n      setEmojiVisible(false);\r\n    }\r\n  };\r\n  const toggleEmoji = () => {\r\n    setEmojiVisible(!emojiVisible);\r\n  };\r\n  const addEmoji = emoji => {\r\n    setValue(value + emoji.native);\r\n  };\r\n  //---------------------FILE\r\n\r\n  let selectFile = async files => {\r\n    let uploaded = attachments.length ? attachments : [];\r\n    for (let i = 0; i < files.length; i++) {\r\n      const file = files[i];\r\n      let uid = Math.random(Math.random() * 1000);\r\n      uploaded = [\r\n        ...uploaded,\r\n        {\r\n          uid,\r\n          name: file.name,\r\n          status: \"done\",\r\n          url:\r\n            \"https://cdn.lowgif.com/small/dc86e54ceca03be4-loading-spinner-animated-gif-83320-mediabin.gif\"\r\n        }\r\n      ];\r\n      setAttachments(uploaded);\r\n      setIsDisabled(true);\r\n      // eslint-disable-next-line no-loop-func\r\n      await upload(file).then(file => {\r\n        uploaded = uploaded.map(item => {\r\n          if (item.uid === uid) {\r\n            return {\r\n              uid: file._id,\r\n              name: file.filename,\r\n              status: \"done\",\r\n              url: file.url.replace(/http/, \"https\")\r\n            };\r\n          }\r\n          return item;\r\n        });\r\n      });\r\n    }\r\n    setAttachments(uploaded);\r\n    setIsDisabled(false);\r\n  };\r\n  const inputRef = useCallback(\r\n    node => {\r\n      if (node) {\r\n        let margin = 40;\r\n        let elHeight = node.offsetHeight + margin + 93.5;\r\n\r\n        if (attachments.length > 0) {\r\n          elHeight = elHeight + 112;\r\n        }\r\n        const el = document.querySelector(\".chat__dialog-messages\");\r\n        if (el) {\r\n          el.style.height = `calc(100% - ${elHeight}px)`;\r\n          if (value.length === 0 && !attachments.length) {\r\n            el.style.height = `calc(100% - 185px)`;\r\n          }\r\n        }\r\n      }\r\n    },\r\n    [value, attachments]\r\n  );\r\n\r\n  useEffect(() => {\r\n    const el = document.querySelector(\".chat-input__smile-btn\");\r\n    document.addEventListener(\"click\", e => onOutSideClick(e, el));\r\n    return () => {\r\n      document.removeEventListener(\"click\", e => {\r\n        onOutSideClick(e, el);\r\n      });\r\n    };\r\n  }, [currentDialogId]);\r\n  if (!currentDialogId) {\r\n    return null;\r\n  }\r\n  return (\r\n    currentDialogId && (\r\n      <ChatInputBase\r\n        inputRef={inputRef}\r\n        value={value}\r\n        setValue={setValue}\r\n        toggleEmoji={toggleEmoji}\r\n        emojiVisible={emojiVisible}\r\n        setEmojiVisible={setEmojiVisible}\r\n        addEmoji={addEmoji}\r\n        selectFile={selectFile}\r\n        attachments={attachments}\r\n        removeAttachment={removeAttachment}\r\n        isDisabled={isDisabled}\r\n        handleSendMessage={handleSendMessage}\r\n        onSendMessage={onSendMessage}\r\n        isRecording={isRecording}\r\n        handleStartRecording={handleStartRecording}\r\n        onStopRecording={onStopRecording}\r\n        onRecord={onRecord}\r\n      />\r\n    )\r\n  );\r\n};\r\nexport default connect(\r\n  ({ dialogs, attachments, user }) => ({\r\n    currentDialogId: dialogs.currentDialogId,\r\n    attachments: attachments.items\r\n  }),\r\n  { ...messagesActions, ...attachmentsActions }\r\n)(ChatInput);\r\n","import React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { Status as StatusBase } from \"../components\";\r\n\r\nconst Status = ({ currentDialogId, dialogs, userId }) => {\r\n  if (dialogs.length < 1 || !currentDialogId) {\r\n    return null;\r\n  }\r\n  const currentDialogObj = dialogs.filter(item => {\r\n    return item._id === currentDialogId;\r\n  })[0];\r\n\r\n  if (currentDialogObj) {\r\n    let partner =\r\n      userId === currentDialogObj.author._id\r\n        ? currentDialogObj.partner\r\n        : currentDialogObj.author;\r\n\r\n    return <StatusBase online={partner.isOnline} fullname={partner.fullname} />;\r\n  } else {\r\n    return null;\r\n  }\r\n};\r\nexport default connect(({ dialogs, user }) => ({\r\n  currentDialogId: dialogs.currentDialogId,\r\n  dialogs: dialogs.items,\r\n  userId: user.data.user._id\r\n}))(Status);\r\n","import React, { useState } from \"react\";\r\nimport { Sidebar as SidebarBase } from \"../components\";\r\nimport { userApi } from \"../utils/api\";\r\nimport { connect } from \"react-redux\";\r\nimport { dialogsActions } from \"../redux/actions\";\r\nimport { withRouter } from \"react-router-dom\";\r\n\r\nlet Sidebar = props => {\r\n  let [visible, setVisible] = useState(false);\r\n  let [isLoading, setIsLoading] = useState(false);\r\n  let [users, setUsers] = useState([]);\r\n  let [newMessageText, setNewMessageText] = useState(\"\");\r\n  let [partner, setPartner] = useState(null);\r\n  let [selectInputValue, setSelectInputValue] = useState(undefined);\r\n  let showModal = () => {\r\n    setVisible(true);\r\n  };\r\n\r\n  let handleOk = async () => {\r\n    setIsLoading(true);\r\n    setNewMessageText(\"\");\r\n    setSelectInputValue(undefined);\r\n    setUsers([]);\r\n    setPartner(null);\r\n    setIsLoading(false);\r\n    setVisible(false);\r\n    setIsLoading(false);\r\n    setVisible(false);\r\n    props.createDialog({ text: newMessageText, partner }).then(data => {\r\n      if (data && data.status === \"success\") {\r\n        props.history.push(`/dialog/${data.dialog._id}`);\r\n      }\r\n    });\r\n  };\r\n\r\n  let handleCancel = () => {\r\n    setVisible(false);\r\n    setSelectInputValue(undefined);\r\n    setPartner(null);\r\n    setUsers([]);\r\n  };\r\n\r\n  //------------------SELECT HANDLERS\r\n  function onInputSelect(value) {\r\n    setPartner(value);\r\n  }\r\n  function onInputChange(value) {\r\n    setSelectInputValue(value);\r\n  }\r\n\r\n  let onSearch = async val => {\r\n    try {\r\n      let data = await userApi.findUsers(val);\r\n      if (data.status === \"success\") {\r\n        setUsers(data.users);\r\n      }\r\n    } catch (err) {\r\n      console.error(err);\r\n    }\r\n  };\r\n\r\n  //-------------------NEW MESSAGE FORM HANDLERS\r\n  let onAddNewMessage = e => {\r\n    setNewMessageText(e.target.value);\r\n  };\r\n  return (\r\n    <SidebarBase\r\n      isLoading={isLoading}\r\n      visible={visible}\r\n      showModal={showModal}\r\n      handleCancel={handleCancel}\r\n      handleOk={handleOk}\r\n      onInputSelect={onInputSelect}\r\n      users={users}\r\n      onSearch={onSearch}\r\n      onAddNewMessage={onAddNewMessage}\r\n      partner={partner}\r\n      newMessageText={newMessageText}\r\n      selectInputValue={selectInputValue}\r\n      onInputChange={onInputChange}\r\n    />\r\n  );\r\n};\r\nexport default withRouter(connect(null, dialogsActions)(Sidebar));\r\n","import React from \"react\";\r\nimport { Button, Icon, Modal, Select, Form, Input } from \"antd\";\r\nimport { Dialogs } from \"../../containers\";\r\nconst { Option } = Select;\r\n\r\nlet Sidebar = props => {\r\n  let {\r\n    isLoading,\r\n    visible,\r\n    modalText,\r\n    showModal,\r\n    handleCancel,\r\n    handleOk,\r\n    onInputSelect,\r\n    onInputChange,\r\n    users,\r\n    onSearch,\r\n    onAddNewMessage,\r\n    partner,\r\n    newMessageText,\r\n    selectInputValue\r\n  } = props;\r\n\r\n  let options = users.map(user => (\r\n    <Option key={user._id}>{user.fullname}</Option>\r\n  ));\r\n  return (\r\n    <div className=\"chat__sidebar\">\r\n      <div className=\"chat__sidebar-header\">\r\n        <div>\r\n          <Icon type=\"team\" />\r\n          <span>Список диалогов</span>\r\n        </div>\r\n        <Button onClick={showModal} type=\"link\" shape=\"circle\" icon=\"form\" />\r\n      </div>\r\n\r\n      <div className=\"chat__sidebar-dialogs\">\r\n        <Dialogs userId=\"dfgf9e7079856ccaa8abeef5b\" />\r\n      </div>\r\n      <div>\r\n        <Modal\r\n          title=\"Создать диалог\"\r\n          visible={visible}\r\n          confirmLoading={isLoading}\r\n          onCancel={handleCancel}\r\n          footer={[\r\n            <Button key=\"back\" onClick={handleCancel}>\r\n              Закрыть\r\n            </Button>,\r\n            <Button\r\n              disabled={!newMessageText}\r\n              key=\"submit\"\r\n              type=\"primary\"\r\n              loading={isLoading}\r\n              onClick={handleOk}\r\n            >\r\n              Создать\r\n            </Button>\r\n          ]}\r\n        >\r\n          <p>{modalText}</p>\r\n\r\n          <Form className=\"add-dialog-form\">\r\n            <Form.Item label=\"Введите имя пользователя или E-Mail\">\r\n              <Select\r\n                showSearch\r\n                style={{ width: \"100%\" }}\r\n                optionFilterProp=\"children\"\r\n                onChange={onInputChange}\r\n                onSelect={onInputSelect}\r\n                onSearch={onSearch}\r\n                filterOption={false}\r\n                placeholder=\"Имя пользователя или E-mail\"\r\n                value={selectInputValue}\r\n              >\r\n                {options}\r\n              </Select>\r\n            </Form.Item>\r\n            {partner && (\r\n              <Form.Item label=\"Введите текст сообщения\">\r\n                <Input.TextArea\r\n                  onChange={onAddNewMessage}\r\n                  autoSize={{ minRows: 2, maxRows: 6 }}\r\n                  value={newMessageText}\r\n                  placeholder=\"Текст сообщения...\"\r\n                />\r\n              </Form.Item>\r\n            )}\r\n          </Form>\r\n        </Modal>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\nexport default Sidebar;\r\n","import React, { useState, useEffect } from \"react\";\r\n\r\nimport { Upload, Modal } from \"antd\";\r\n\r\nfunction getBase64(file) {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.readAsDataURL(file);\r\n    reader.onload = () => resolve(reader.result);\r\n    reader.onerror = error => reject(error);\r\n  });\r\n}\r\nlet UploadFiles = ({ attachments, removeAttachment }) => {\r\n  let [previewVisible, setPreviewVisible] = useState(false);\r\n  let [previewImage, setPreviewImage] = useState(\"\");\r\n  let [fileList, setFileList] = useState(attachments);\r\n\r\n  let handleCancel = () => {\r\n    setPreviewVisible(false);\r\n  };\r\n\r\n  let handlePreview = async file => {\r\n    if (!file.url && !file.preview) {\r\n      file.preview = await getBase64(file.originFileObj);\r\n    }\r\n    setPreviewImage(file.url || file.preview);\r\n    setPreviewVisible(true);\r\n  };\r\n\r\n  let handleChange = ({ fileList }) => setFileList({ fileList });\r\n\r\n  useEffect(() => {\r\n    setFileList(attachments);\r\n  }, [attachments]);\r\n  return (\r\n    <div className=\"clearfix\">\r\n      <Upload\r\n        action=\"https://www.mocky.io/v2/5cc8019d300000980a055e76\"\r\n        listType=\"picture-card\"\r\n        fileList={fileList}\r\n        onPreview={handlePreview}\r\n        onChange={handleChange}\r\n        onRemove={file => {\r\n          removeAttachment(file);\r\n        }}\r\n      ></Upload>{\" \"}\r\n      <Modal visible={previewVisible} footer={null} onCancel={handleCancel}>\r\n        <img alt=\"example\" style={{ width: \"100%\" }} src={previewImage} />\r\n      </Modal>{\" \"}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UploadFiles;\r\n","import React from \"react\";\r\nimport { Result } from \"antd\";\r\nimport { withRouter } from \"react-router-dom\";\r\n\r\nlet ErrorIndicator = () => {\r\n  return <Result status=\"500\" subTitle=\"Что-то пошло не так.\" />;\r\n};\r\n\r\nexport default withRouter(ErrorIndicator);\r\n","import React, { Component } from \"react\";\r\nimport ErrorIndicator from \"../ErrorIndicator\";\r\n\r\nclass ErrorBoundry extends Component {\r\n  state = {\r\n    errorIndicator: false\r\n  };\r\n  static getDerivedStateFromError(error) {\r\n    // Обновить состояние с тем, чтобы следующий рендер показал запасной UI.\r\n    return { errorIndicator: true };\r\n  }\r\n\r\n  // componentDidCatch() {\r\n  //   this.setState({ errorIndicator: true });\r\n  // }\r\n\r\n  render() {\r\n    if (this.state.errorIndicator) {\r\n      return <ErrorIndicator />;\r\n    }\r\n\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\nexport default ErrorBoundry;\r\n","import React from \"react\";\r\n\r\nimport { Form } from \"antd\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { Redirect } from \"react-router-dom\";\r\n\r\nimport { Button, Block, FormField } from \"../../../components\";\r\n\r\nconst LoginForm = props => {\r\n  const {\r\n    touched,\r\n    errors,\r\n    handleChange,\r\n    handleBlur,\r\n    handleSubmit,\r\n    isSubmitting,\r\n    isAuth\r\n  } = props;\r\n  if (isAuth) {\r\n    return <Redirect to=\"/\" />;\r\n  }\r\n  return (\r\n    <div>\r\n      {\" \"}\r\n      <div className=\"auth__top\">\r\n        <h2>Войти в аккаунт</h2>\r\n        <p>Пожалуйста, войдите в свой аккаунт</p>\r\n      </div>\r\n      <Block>\r\n        <Form onSubmit={handleSubmit} className=\"login-form\">\r\n          <FormField\r\n            errors={errors}\r\n            touched={touched}\r\n            placeholder=\"E-mail\"\r\n            handleChange={handleChange}\r\n            handleBlur={handleBlur}\r\n            type=\"email\"\r\n            icon=\"mail\"\r\n            id=\"email\"\r\n          />\r\n          <FormField\r\n            errors={errors}\r\n            touched={touched}\r\n            placeholder=\"Пароль\"\r\n            handleChange={handleChange}\r\n            handleBlur={handleBlur}\r\n            type=\"password\"\r\n            icon=\"lock\"\r\n            id=\"password\"\r\n          />\r\n\r\n          <Form.Item>\r\n            <Button\r\n              type=\"primary\"\r\n              size=\"large\"\r\n              onClick={handleSubmit}\r\n              loading={isSubmitting}\r\n              disabled={isSubmitting}\r\n            >\r\n              Войти в аккаунт\r\n            </Button>\r\n          </Form.Item>\r\n          <Link className=\"auth__register-link\" to=\"/signup\">\r\n            Зарегистрироваться\r\n          </Link>\r\n        </Form>\r\n      </Block>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LoginForm;\r\n","import React, { Component } from \"react\";\r\n\r\nexport default class ErrorButton extends Component {\r\n  state = {\r\n    renderError: false\r\n  };\r\n\r\n  render() {\r\n    if (this.state.renderError) {\r\n      this.foo.bar = 0;\r\n    }\r\n\r\n    return (\r\n      <button onClick={() => this.setState({ renderError: true })}>\r\n        Throw Error\r\n      </button>\r\n    );\r\n  }\r\n}\r\n","export default ({ isAuth, errors, values }) => {\r\n  const rules = {\r\n    email: value => {\r\n      if (!value) {\r\n        errors.email = \"Введите почту\";\r\n      } else if (!/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,4}$/i.test(value)) {\r\n        errors.email = \"Неправильный адресс почты\";\r\n      }\r\n    },\r\n    password: value => {\r\n      if (!value) {\r\n        errors.password = \"Введите пароль\";\r\n      } else if (value.length < 6) {\r\n        !isAuth && (errors.password = \"Слишком лёгкий пароль\");\r\n      }\r\n    },\r\n    password_2: value => {\r\n      if (value !== values.password) {\r\n        errors.password_2 = \"Пароли не совпадают\";\r\n      }\r\n    },\r\n    fullname: value => {\r\n      if (!value) {\r\n        errors.fullname = \"Введите ваше имя\";\r\n      } else if (value.length < 4) {\r\n        errors.fullname = \"Имя должно содержать не меньше 4 символов\";\r\n      }\r\n    }\r\n  };\r\n\r\n  Object.keys(values).forEach(key => rules[key] && rules[key](values[key]));\r\n};\r\n","import LoginForm from \"../components/LoginForm\";\r\nimport { withFormik } from \"formik\";\r\nimport validateFunc from \"./../../../utils/validations\";\r\nimport store from \"../../../redux/store\";\r\nimport { userActions } from \"../../../redux/actions\";\r\nimport { connect } from \"react-redux\";\r\n\r\nconst LoginFormContainer = withFormik({\r\n  // Custom sync validation\r\n\r\n  mapPropsToValues: () => ({ email: \"\", password: \"\" }),\r\n  validate: values => {\r\n    let errors = {};\r\n    validateFunc({ isAuth: true, errors, values });\r\n    return errors;\r\n  },\r\n\r\n  handleSubmit: async (values, { setSubmitting, props }) => {\r\n    try {\r\n      let data = await store.dispatch(userActions.fetchLoginData(values));\r\n      setSubmitting(false);\r\n      if (data.status === \"success\") {\r\n        const data = await store.dispatch(userActions.fetchUserData());\r\n        if (data.data.status === \"success\") {\r\n          await store.dispatch({ type: \"USER:SET_IS_AUTH\", payload: true });\r\n          await store.dispatch({ type: \"INITIALIZED_SUCCESS\" });\r\n          props.history.push(\"/\");\r\n        }\r\n      }\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  },\r\n  displayName: \"LoginForm\"\r\n})(LoginForm);\r\n\r\nexport default connect(({ user }) => {\r\n  return {\r\n    isAuth: user.isAuth\r\n  };\r\n})(LoginFormContainer);\r\n","import LoginForm from './containers/LoginForm';\r\nexport default LoginForm;","import React from \"react\";\r\nimport { Form, Icon } from \"antd\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nimport { Button, Block, FormField } from \"../../../components\";\r\n\r\nconst success = false;\r\nconst RegisterForm = props => {\r\n  const {\r\n    touched,\r\n    errors,\r\n    handleChange,\r\n    handleBlur,\r\n    handleSubmit,\r\n    isSubmitting\r\n  } = props;\r\n\r\n  return (\r\n    <div>\r\n      {\" \"}\r\n      <div className=\"auth__top\">\r\n        <h2>Регистрация</h2>\r\n        <p>Для входа в чат вам нужно зарегистрироваться</p>\r\n      </div>\r\n      <Block>\r\n        {!success ? (\r\n          <Form onSubmit={handleSubmit} className=\"login-form\">\r\n            <FormField\r\n              errors={errors}\r\n              touched={touched}\r\n              placeholder=\"E-mail\"\r\n              handleChange={handleChange}\r\n              handleBlur={handleBlur}\r\n              type=\"email\"\r\n              icon=\"mail\"\r\n              id=\"email\"\r\n            />\r\n            <FormField\r\n              errors={errors}\r\n              touched={touched}\r\n              placeholder=\"Ваше имя\"\r\n              handleChange={handleChange}\r\n              handleBlur={handleBlur}\r\n              type=\"text\"\r\n              icon=\"user\"\r\n              id=\"fullname\"\r\n            />\r\n            <FormField\r\n              errors={errors}\r\n              touched={touched}\r\n              placeholder=\"Пароль\"\r\n              handleChange={handleChange}\r\n              handleBlur={handleBlur}\r\n              type=\"password\"\r\n              icon=\"lock\"\r\n              id=\"password\"\r\n            />\r\n            <FormField\r\n              errors={errors}\r\n              touched={touched}\r\n              placeholder=\"Повторите пароль\"\r\n              handleChange={handleChange}\r\n              handleBlur={handleBlur}\r\n              type=\"password\"\r\n              icon=\"lock\"\r\n              id=\"password_2\"\r\n            />\r\n\r\n            <Form.Item>\r\n              <Button\r\n                disabled={isSubmitting}\r\n                type=\"primary\"\r\n                size=\"large\"\r\n                onClick={handleSubmit}\r\n              >\r\n                Зарегистрироваться\r\n              </Button>\r\n            </Form.Item>\r\n            <Link className=\"auth__register-link\" to=\"/signin\">\r\n              Войти в аккаунт\r\n            </Link>\r\n          </Form>\r\n        ) : (\r\n          <div className=\"auth__success-block\">\r\n            <div>\r\n              <Icon type=\"info-circle\" theme=\"twoTone\" />\r\n            </div>\r\n            <h2>Подтвердите свой аккаунт</h2>\r\n            <p>\r\n              На вашу почту отправлено письмо с ссылкой на подтверждения\r\n              аккаунта.\r\n            </p>\r\n          </div>\r\n        )}\r\n      </Block>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default RegisterForm;\r\n","import RegisterForm from './containers/RegisterForm';\r\nexport default RegisterForm;","import RegisterForm from \"../components/RegisterForm\";\r\nimport { withFormik } from \"formik\";\r\nimport validateFunc from \"./../../../utils/validations\";\r\nimport store from \"../../../redux/store\";\r\nimport actions from \"../../../redux/actions/user\";\r\n\r\nexport default withFormik({\r\n  // Custom sync validation\r\n  mapPropsToValues: () => ({\r\n    email: \"\",\r\n    password: \"\",\r\n    password_2: \"\",\r\n    fullname: \"\"\r\n  }),\r\n  validate: values => {\r\n    let errors = {};\r\n    validateFunc({ isAuth: false, errors, values });\r\n    return errors;\r\n  },\r\n\r\n  handleSubmit: async (values, { setSubmitting, props }) => {\r\n    const { email, password, fullname } = values;\r\n    try {\r\n      let data = await store.dispatch(\r\n        actions.signUserUp({ fullname, password, email })\r\n      );\r\n      if (data.data.status === \"success\") {\r\n        props.history.push(\"/user/verify\");\r\n      }\r\n    } catch (err) {\r\n      console.log(err);\r\n      setSubmitting(false);\r\n    }\r\n  },\r\n  displayName: \"RegisterForm\"\r\n})(RegisterForm);\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { Result, Button, Spin } from \"antd\";\r\nimport { Block } from \"../../../components\";\r\nimport userApi from \"../../../utils/api/user\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nlet renderTextInfo = ({ verified, hash, loading, error }) => {\r\n  if (hash) {\r\n    if (verified) {\r\n      return {\r\n        status: \"success\",\r\n        title: \"Готово!\",\r\n        message: \"Ваш аккаунт успешно подтвержден\",\r\n        extra: [\r\n          <Link to=\"/signin\" key=\"123\">\r\n            <Button type=\"primary\">Ввойти в аккаунт</Button>\r\n          </Link>\r\n        ]\r\n      };\r\n    } else if (error) {\r\n      return {\r\n        status: \"error\",\r\n        title: \"Ошибка\",\r\n        message: \"Неудалось подтвердить аккаунт \"\r\n      };\r\n    }\r\n  } else {\r\n    return {\r\n      status: \"success\",\r\n      title: \"Регистрация прошла успешно!\",\r\n      message: \"Ссылка для подтверждения аккаунта отправлена на почту\"\r\n    };\r\n  }\r\n};\r\n\r\nexport default function CheckEmailInfo(props) {\r\n  const hash = props.location.search.split(\"?hash=\")[1];\r\n\r\n  let [verified, setVerified] = useState(null);\r\n  let [loading, setIsLoading] = useState(false);\r\n  let [error, setError] = useState(false);\r\n\r\n  let info = renderTextInfo({ verified, hash, loading, error });\r\n  useEffect(() => {\r\n    if (hash) {\r\n      userApi\r\n        .verifyHash(hash)\r\n        .then(async data => {\r\n          setIsLoading(true);\r\n          console.log(data);\r\n          if (data.data.status === \"success\") {\r\n            setVerified(true);\r\n            setIsLoading(false);\r\n          }\r\n        })\r\n        .catch(err => {\r\n          setError(true);\r\n          setIsLoading(false);\r\n        });\r\n    }\r\n  }, [hash]);\r\n  if (loading || !info) {\r\n    return <Spin />;\r\n  }\r\n  return (\r\n    <Block>\r\n      <Result\r\n        status={info.status}\r\n        extra={info.extra}\r\n        title={info.title}\r\n        subTitle={info.message}\r\n      />\r\n    </Block>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { Route, Switch } from \"react-router-dom\";\r\n\r\nimport { LoginForm, RegisterForm } from \"../../modules/index\";\r\nimport CheckEmailInfo from \"./components/CheckEmailInfo\";\r\n\r\nimport \"./Auth.scss\";\r\n\r\nconst Auth = () => {\r\n  return (\r\n    <section className=\"auth\">\r\n      <div className=\"auth__content\">\r\n        <Switch>\r\n          <Route exact path=\"/signup\" component={RegisterForm} />\r\n          <Route exact path=\"/user/verify\" component={CheckEmailInfo} />\r\n          <Route path={[\"/\", \"/signin\"]} component={LoginForm} />\r\n        </Switch>\r\n      </div>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default Auth;\r\n","import React, { useEffect } from \"react\";\r\nimport { Icon } from \"antd\";\r\nimport { Messages, ChatInput, Status, Sidebar } from \"../../containers\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport { dialogsActions, userActions } from \"../../redux/actions\";\r\nimport \"./Home.scss\";\r\nimport { Redirect } from \"react-router-dom\";\r\n\r\nfunction Home(props) {\r\n  let { setCurrentDialog, signOut, isAuth, fullname } = props;\r\n  let onSignOut = () => {\r\n    let check = window.confirm(\r\n      `${fullname}, вы уверенны что хотите выйти из аккаунта?`\r\n    );\r\n    if (check) {\r\n      signOut();\r\n    }\r\n  };\r\n  useEffect(() => {\r\n    return () => {\r\n      console.log(1);\r\n      props.history.push(\"/\");\r\n    };\r\n  }, []);\r\n  useEffect(() => {\r\n    let path = props.location.pathname;\r\n    let dialogId = path.split(\"/\").pop();\r\n    if (dialogId.length === 24) {\r\n      setCurrentDialog(dialogId);\r\n    }\r\n  }, [props.location.pathname, setCurrentDialog]);\r\n\r\n  return (\r\n    isAuth && (\r\n      <section className=\"home\">\r\n        <div className=\"chat\">\r\n          <Sidebar />\r\n          <div className=\"chat__dialog\">\r\n            <div className=\"chat__dialog-header\">\r\n              <div />\r\n              <Status />\r\n              <div>\r\n                {\" \"}\r\n                <Icon\r\n                  style={{\r\n                    fontSize: \"20px\",\r\n                    marginRight: \"10px\",\r\n                    color: \"#389990\",\r\n                    cursor: \"pointer\"\r\n                  }}\r\n                  type=\"logout\"\r\n                  onClick={onSignOut}\r\n                />\r\n              </div>\r\n            </div>\r\n            <Messages />\r\n            <div className=\"chat__dialog-input\">\r\n              <ChatInput />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n    )\r\n  );\r\n}\r\nexport default withRouter(\r\n  connect(\r\n    ({ user }) => ({ isAuth: user.isAuth, fullname: user.data.user.fullname }),\r\n    {\r\n      ...dialogsActions,\r\n      ...userActions\r\n    }\r\n  )(Home)\r\n);\r\n","import React, { useEffect } from \"react\";\nimport { Route, Switch } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport { Spin, Result } from \"antd\";\n\nimport { appActions } from \"./redux/actions\";\nimport { Auth, Home } from \"./pages\";\nfunction App(props) {\n  let { isAuth, initializeApp, isInitialized } = props;\n  useEffect(() => {\n    initializeApp();\n  }, [isAuth, initializeApp]);\n\n  if (!isInitialized) {\n    return (\n      <Spin\n        style={{\n          position: \"absolute\",\n          left: \"50%\",\n          top: \"50%\",\n          transform: \"translate(-50%, -50%)\"\n        }}\n        size=\"large\"\n        tip=\"Загрузка...\"\n      />\n    );\n  }\n  return (\n    <div className=\"wrapper\">\n      {\" \"}\n      <Switch>\n        {isAuth && (\n          <Route exact path=\"/:dialog?/:id?\" render={() => <Home />} />\n        )}\n        <Route\n          exact\n          path={[\"/\", \"/signin\", \"/signup\", \"/user/verify\"]}\n          component={Auth}\n        />\n        <Route\n          render={() => {\n            return (\n              <Result\n                status=\"404\"\n                title=\"404\"\n                subTitle=\"Sorry, the page you visited does not exist.\"\n              />\n            );\n          }}\n        />\n      </Switch>\n    </div>\n  );\n}\nexport default connect(\n  ({ user, app }) => ({\n    isAuth: user.isAuth,\n    isInitialized: app.isInitialized\n  }),\n  appActions\n)(App);\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { HashRouter as Router } from \"react-router-dom\";\nimport { Provider } from \"react-redux\";\nimport store from \"./redux/store\";\nimport { ErrorBoundry } from \"./components\";\n\nimport App from \"./App\";\n\nimport \"./styles/index.scss\";\n\nReactDOM.render(\n  <Provider store={store}>\n    <Router>\n      <ErrorBoundry>\n        <App />\n      </ErrorBoundry>\n    </Router>\n  </Provider>,\n  document.getElementById(\"root\")\n);\n","export const SET_ITEMS = \"DIALOGS:SET_ITEMS\";\r\nexport const SET_CURRENT_DIALOG = \"DIALOGS:SET_CURRENT_DIALOG\";\r\nexport const UPDATE_DIALOG = \"DIALOGS:UPDATE_DIALOG\";\r\nexport const SET_IS_LOADING = \"DIALOGS:SET_IS_LOADING\";\r\n\r\nconst initialState = {\r\n  items: [],\r\n  currentDialogId: null,\r\n  isLoading: false\r\n};\r\n\r\nexport default (state = initialState, { type, payload }) => {\r\n  switch (type) {\r\n    case SET_ITEMS:\r\n      return {\r\n        ...state,\r\n        items: payload\r\n      };\r\n\r\n    case SET_CURRENT_DIALOG:\r\n      return {\r\n        ...state,\r\n        currentDialogId: payload\r\n      };\r\n    case UPDATE_DIALOG:\r\n      let newItems = state.items.map(item => {\r\n        if (item._id === payload._id) {\r\n          item = payload;\r\n        }\r\n        return item;\r\n      });\r\n      return {\r\n        ...state,\r\n        items: newItems\r\n      };\r\n\r\n    case SET_IS_LOADING:\r\n      return {\r\n        ...state,\r\n        isLoading: payload\r\n      };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","export const SET_ITEMS = \"MESSAGES:SET_ITEMS\";\r\nexport const SET_IS_LOADING = \"MESSAGES:SET_IS_LOADING\";\r\nexport const ADD_MESSAGE = \"MESSAGES:ADD_MESSAGE\";\r\nexport const REMOVE_MESSAGE = \"MESSAGES:REMOVE_MESSAGE\";\r\n\r\nconst initialState = {\r\n  items: [],\r\n  isLoading: false\r\n};\r\n\r\nexport default (state = initialState, { type, payload }) => {\r\n  switch (type) {\r\n    case SET_ITEMS:\r\n      return {\r\n        ...state,\r\n        items: payload\r\n      };\r\n\r\n    case SET_IS_LOADING:\r\n      return {\r\n        ...state,\r\n        isLoading: payload\r\n      };\r\n    case ADD_MESSAGE:\r\n      return {\r\n        ...state,\r\n        items: [...state.items, payload]\r\n      };\r\n    case REMOVE_MESSAGE:\r\n      return {\r\n        ...state,\r\n        items: state.items.filter(message => message._id !== payload)\r\n      };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import { combineReducers } from \"redux\";\r\n\r\nconst reducers = [\"user\", \"dialogs\", \"messages\", \"app\", \"attachments\"];\r\n\r\nexport default combineReducers(\r\n  reducers.reduce((initial, name) => {\r\n    initial[name] = require(`./${name}`).default;\r\n    return initial;\r\n  }, {})\r\n);\r\n","export const INITIALIZED_SUCCESS = \"APP:INITIALIZED_SUCCESS\";\r\n\r\nconst initialState = {\r\n  isInitialized: false\r\n};\r\n\r\nexport default (state = initialState, { type, payload }) => {\r\n  switch (type) {\r\n    case INITIALIZED_SUCCESS:\r\n      return {\r\n        ...state,\r\n        isInitialized: true\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","export const SET_ATTACHMENTS = \"ATTACHMENTS:SET_ATTACHMENTS\";\r\nexport const REMOVE_ATTACHMENT = \"ATTACHMENTS:REMOVE_ATTACHMENT\";\r\n\r\nconst initialState = {\r\n  items: []\r\n};\r\n\r\nexport default (state = initialState, { type, payload }) => {\r\n  switch (type) {\r\n    case SET_ATTACHMENTS:\r\n      return {\r\n        ...state,\r\n        items: payload\r\n      };\r\n    case REMOVE_ATTACHMENT:\r\n      return {\r\n        ...state,\r\n        items: state.items.filter(item => item.uid !== payload.uid)\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","export const SET_USER_DATA = \"USER:SET_USER_DATA\";\r\nexport const SET_IS_AUTH = \"USER:SET_IS_AUTH\";\r\n\r\nconst initialState = {\r\n  data: null,\r\n  isAuth: window.localStorage.token ? true : false\r\n};\r\n\r\nexport default (state = initialState, { type, payload }) => {\r\n  switch (type) {\r\n    case SET_USER_DATA:\r\n      return {\r\n        ...state,\r\n        data: payload\r\n      };\r\n    case SET_IS_AUTH:\r\n      return {\r\n        ...state,\r\n        isAuth: payload\r\n      };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n"],"sourceRoot":""}